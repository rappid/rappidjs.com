define(["js/core/DomElement","js/core/List","js/core/Bindable"],function(e,t,n){var r,i=e.inherit("js.svg.SvgElement",{defaults:{transformations:t,_transform:null,translateX:r,translateY:r,scaleX:r,scaleY:r,rotation:r,rotationX:r,rotationY:r},$classAttributes:["transformations","translateX","translateY","scaleX","scaleY","rotation","rotationX","rotationY"],ctor:function(){this.$namespace=i.SVG_NAMESPACE,this.callBase(),this.bind("transformations","*",this._refreshTransform,this)},transform:function(e){return this.$transform?this.$transform.set("transform",e):(this.$transform=new i.Transform({transform:e}),this.$.transformations.add(this.$transform)),this},addChild:function(e){this.callBase(),e.$svgRoot=this.$svgRoot},getSvgRoot:function(){if(!this.$svgRoot){var e=this.$parent;while(e instanceof i&&!e.$svgRoot)e=e.$parent;return e?e.$svgRoot:null}return this.$svgRoot},_commitChangedAttributes:function(e){var t,n,i;this._hasSome(e,["translateX","translateY"])&&(t=this.$.translateX,n=this.$.translateY,(t!==r||n!==r)&&this.translate(t,n)),this._hasSome(e,["scaleX","scaleY"])&&(t=this.$.scaleX,n=this.$.scaleY,(t!==r||n!==r)&&this.scale(t,n)),this._hasSome(e,["rotation","rotationX","rotationY"])&&(i=this.$.rotation,t=this.$.rotationX,n=this.$.rotationY,(t!==r||n!==r||i!==r)&&this.rotate(i,t,n)),this.callBase()},scale:function(e,t){if(e===null||t===null)return;return!t&&t!==0&&(t=e),this.$scale?this.$scale.set({sx:e,sy:t}):(this.$scale=new i.Scale({sx:e,sy:t}),this.$.transformations.add(this.$scale)),this},translate:function(e,t){return this.$translate?this.$translate.set({x:e,y:t}):(this.$translate=new i.Translate({x:e,y:t}),this.$.transformations.add(this.$translate)),this},rotate:function(e,t,n){return this.$rotate?this.$rotate.set({r:e,x:t,y:n}):(this.$rotate=new i.Rotate({r:e,x:t,y:n}),this.$.transformations.add(this.$rotate)),this},_refreshTransform:function(){var e=[];this.$.transformations.each(function(t){t instanceof i.TransformBase?e.push(t.toString()):e.push(t)}),this.set("_transform",e.join(" "))},_renderTransform:function(){},_render_transform:function(e){this._setAttribute("transform",e)},_renderHref:function(e){this._setAttribute("href",e,i.XLINK_NAMESPACE)},_renderId:function(e){this._setAttribute("id",e)},localToGlobalFactor:function(){return this.$parent?this.$parent.localToGlobalFactor():{x:1,y:1}},globalToLocalFactor:function(){return this.$parent?this.$parent.globalToLocalFactor():{x:1,y:1}},localPointToGlobal:function(e){var t=this.localToGlobalFactor();return{x:e.x*t.x,y:e.y*t.y}},globalPointToLocal:function(e){var t=this.globalToLocalFactor();return{x:e.x*t.x,y:e.y*t.y}}});return i.XLINK_NAMESPACE="http://www.w3.org/1999/xlink",i.SVG_NAMESPACE="http://www.w3.org/2000/svg",i.Matrix=function(e,t,n,r,i,s){arguments.length?(this.a=e,this.b=t,this.c=n,this.d=r,this.e=i,this.f=s):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)},i.TransformBase=n.inherit("js.svg.SvgElement.TransformBase",{}),i.Transform=i.TransformBase.inherit("js.svg.SvgElement.Transform",{defaults:{transform:null},toString:function(){return this.$.transform||""}}),i.Translate=i.TransformBase.inherit("js.svg.SvgElement.Translate",{toString:function(){return"translate("+(this.$.x||0)+","+(this.$.y||0)+")"}}),i.Scale=i.TransformBase.inherit("js.svg.SvgElement.Scale",{defaults:{sx:1,sy:1},toString:function(){return"scale("+this.$.sx+","+this.$.sy+")"}}),i.Rotate=i.TransformBase.inherit("js.svg.SvgElement.Rotate",{defaults:{r:0,x:0,y:0},toString:function(){return"rotate("+(this.$.r||0)+","+(this.$.x||0)+","+(this.$.y||0)+")"}}),i});