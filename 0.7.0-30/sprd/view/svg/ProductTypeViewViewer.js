define(["js/svg/SvgElement","xaml!sprd/view/svg/PrintAreaViewer"],function(e,t){return e.inherit("sprd.view.svg.ProductTypeViewViewer",{defaults:{tagName:"g",componentClass:"product-type-view",product:null,productViewer:null,_width:"{productViewer.width}",_height:"{productViewer.height}",_appearance:"{product.appearance}",_view:null,_productType:null,imageService:null},$classAttributes:["productViewer","product","imageService"],ctor:function(){this.$printAreas=[],this.callBase()},url:function(){return this.$.imageService&&this.$._productType&&this.$._view&&this.$._productType.containsAppearance(this.$._appearance)?this.$.imageService.productTypeImage(this.$._productType.$.id,this.$._view.$.id,this.$._appearance.$.id,{width:Math.max(this.$._width,this.$._height),height:Math.max(this.$._width,this.$._height)}):""}.onChange("_width","_height","_appearance"),_initializeRenderer:function(){var t=this.get("_view.size.width"),n=this.get("_view.size.height");if(t<0||n<0)t=n=500;this.$productTypeImage=this.createComponent(e,{tagName:"image",href:"{url()}",x:0,y:0,width:t,height:n}),this.addChild(this.$productTypeImage),this.callBase()},_removePrintAreas:function(){for(var e=0;e<this.$printAreas.length;e++){var t=this.$printAreas[e];t.remove(),t.destroy()}this.$printAreas=[]},_render_view:function(e){this._removePrintAreas();if(e)for(var n=0;n<e.$.viewMaps.$items.length;n++){var r=e.$.viewMaps.$items[n],i=this.createComponent(t,{product:this.$.product,productTypeViewViewer:this,productViewer:this.$.productViewer,_viewMap:r,imageService:this.$.imageService});this.addChild(i),this.$printAreas.push(i)}},getViewerForConfiguration:function(e){var t;for(var n=0;n<this.$printAreas.length;n++){t=this.$printAreas[n].getViewerForConfiguration(e);if(t)return t}return null},_commitProduct:function(e){for(var t=0;t<this.$printAreas.length;t++)this.$printAreas[t].set("product",e)},destroy:function(){this._removePrintAreas(),this.callBase()}})});