define=typeof define!="undefined"?define:function(e,t){var n;module.exports=t(exports,require("..").Query),define=n},define(["exports","Query"],function(e,t){var n={filterItems:function(e,t){var n=e.query.where,r=[];for(var i=0;i<t.length;i++)this._filterItem(t[i],n)&&r.push(t[i]);return r},_filterItem:function(e,n){var r=1,i=n.operator;if(n instanceof t.Where){i==="or"&&(r=0);var s;for(var o=0;o<n.expressions.length;o++){s=this._filterItem(e,n.expressions[o]);if(i==="and")r*=s;else{if(i==="or"&&s)return 1;if(i==="not")return s?0:1}}}else if(n instanceof t.Comparator){var u=n.value,a=n.field,f=this._getValueForItemField(e,a);if(typeof f=="undefined")return 0;switch(i){case"eql":return f==u;case"gt":return f>u;case"lt":return f<u;case"gte":return f>=u;case"lte":return f<=u;case"in":f instanceof Array||(f=[f]);for(var l=0;l<f.length;l++)for(var c in u)if(u.hasOwnProperty(c)&&f[l]==u[c])return 1;return 0;case"between":return f>=u[0]&&f<=u[1];case"like":return(new RegExp(u,"i")).test(f);case"ne":return f!=u;default:return 1}}return r},_getValueForItemField:function(e,t){var n=t.split("."),r=e;while(n.length&&typeof r!="undefined")r=r[n.shift()];return r},sortItems:function(e,t){var n=e.query.sort,r=this;return n?t.sort(function(e,t){var i,s=0;for(var o=0;o<n.length;o++){i=n[o],s=r._compareExpression(e,t,i);if(s!==0)return s}return s}):t},_compareExpression:function(e,t,n){var r=this._getValueForItemField(e,n.field),i=this._getValueForItemField(t,n.field);return r>i?n.direction:r<i?-1*n.direction:0}};return e.Executor=n,e});