var requirejs,require,define;(function(global){function isFunction(e){return ostring.call(e)==="[object Function]"}function isArray(e){return ostring.call(e)==="[object Array]"}function each(e,t){if(e){var n;for(n=0;n<e.length;n+=1)if(e[n]&&t(e[n],n,e))break}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1;n-=1)if(e[n]&&t(e[n],n,e))break}}function hasProp(e,t){return hasOwn.call(e,t)}function eachProp(e,t){var n;for(n in e)if(e.hasOwnProperty(n)&&t(e[n],n))break}function mixin(e,t,n,r){return t&&eachProp(t,function(t,i){if(n||!hasProp(e,i))r&&typeof t!="string"?(e[i]||(e[i]={}),mixin(e[i],t,n,r)):e[i]=t}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeContextModuleFunc(e,t,n){return function(){var r=aps.call(arguments,0),i;return n&&isFunction(i=r[r.length-1])&&(i.__requireJsBuild=!0),r.push(t),e.apply(null,r)}}function addRequireMethods(e,t,n){each([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(r){var i=r[1]||r[0];e[r[0]]=t?makeContextModuleFunc(t[i],n):function(){var e=contexts[defContextName];return e[i].apply(e,arguments)}})}function makeError(e,t,n,r){var i=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=r,n&&(i.originalError=n),i}function newContext(e){function v(e){var t,n;for(t=0;e[t];t+=1){n=e[t];if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===1&&(e[2]===".."||e[0]===".."))break;t>0&&(e.splice(t-1,2),t-=2)}}}function m(e,t,n){var r,i,s,u,a,f,l,c,h,p,d,m=t&&t.split("/"),g=m,y=o.map,b=y&&y["*"];e&&e.charAt(0)==="."&&(t?(o.pkgs[t]?g=m=[t]:g=m.slice(0,m.length-1),e=g.concat(e.split("/")),v(e),i=o.pkgs[r=e[0]],e=e.join("/"),i&&e===r+"/"+i.main&&(e=r)):e.indexOf("./")===0&&(e=e.substring(2)));if(n&&(m||b)&&y){u=e.split("/");for(a=u.length;a>0;a-=1){l=u.slice(0,a).join("/");if(m)for(f=m.length;f>0;f-=1){s=y[m.slice(0,f).join("/")];if(s){s=s[l];if(s){c=s,h=a;break}}}if(c)break;!p&&b&&b[l]&&(p=b[l],d=a)}!c&&p&&(c=p,h=d),c&&(u.splice(0,h,c),e=u.join("/"))}return e}function g(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===r.contextName)return t.parentNode.removeChild(t),!0})}function y(e){var t=o.paths[e];if(t&&isArray(t)&&t.length>1)return g(e),t.shift(),r.undef(e),r.require([e]),!0}function b(e,t,n,i){var s,o,u,a=e?e.indexOf("!"):-1,f=null,c=t?t.name:null,d=e,v=!0,g="";return e||(v=!1,e="_@r"+(h+=1)),a!==-1&&(f=e.substring(0,a),e=e.substring(a+1,e.length)),f&&(f=m(f,c,i),o=l[f]),e&&(f?o&&o.normalize?g=o.normalize(e,function(e){return m(e,c,i)}):g=m(e,c,i):(g=m(e,c,i),s=r.nameToUrl(g))),u=f&&!o&&!n?"_unnormalized"+(p+=1):"",{prefix:f,name:g,parentMap:t,unnormalized:!!u,url:s,originalName:d,isDefine:v,id:(f?f+"!"+g:g)+u}}function w(e){var t=e.id,n=u[t];return n||(n=u[t]=new r.Module(e)),n}function E(e,t,n){var r=e.id,i=u[r];hasProp(l,r)&&(!i||i.defineEmitComplete)?t==="defined"&&n(l[r]):w(e).on(t,n)}function S(e,t){var n=e.requireModules,r=!1;t?t(e):(each(n,function(t){var n=u[t];n&&(n.error=e,n.events.error&&(r=!0,n.emit("error",e)))}),r||req.onError(e))}function x(){globalDefQueue.length&&(apsp.apply(f,[f.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function T(e,t,n){var i=e&&e.map,s=makeContextModuleFunc(n||r.require,i,t);return addRequireMethods(s,r,i),s.isBrowser=isBrowser,s}function N(e){delete u[e],each(d,function(t,n){if(t.map.id===e)return d.splice(n,1),t.defined||(r.waitCount-=1),!0})}function C(e,t,n){var r=e.map.id,i=e.depMaps,s;if(!e.inited)return;return t[r]?e:(t[r]=!0,each(i,function(e){var r=e.id,i=u[r];if(!i||n[r]||!i.inited||!i.enabled)return;return s=C(i,t,n)}),n[r]=!0,s)}function k(e,t,n){var r=e.map.id,s=e.depMaps;if(!e.inited||!e.map.isDefine)return;return t[r]?l[r]:(t[r]=e,each(s,function(s){var o=s.id,a=u[o],f;if(i[o])return;if(a){if(!a.inited||!a.enabled){n[r]=!0;return}f=k(a,t,n),n[o]||e.defineDepById(o,f)}}),e.check(!0),l[r])}function L(e){e.check()}function A(){var e,n,i,a,f=o.waitSeconds*1e3,l=f&&r.startTime+f<(new Date).getTime(),c=[],h=!1,p=!0;if(t)return;t=!0,eachProp(u,function(t){e=t.map,n=e.id;if(!t.enabled)return;if(!t.error)if(!t.inited&&l)y(n)?(a=!0,h=!0):(c.push(n),g(n));else if(!t.inited&&t.fetched&&e.isDefine){h=!0;if(!e.prefix)return p=!1}});if(l&&c.length)return i=makeError("timeout","Load timeout for modules: "+c,null,c),i.contextName=r.contextName,S(i);p&&(each(d,function(e){if(e.defined)return;var t=C(e,{},{}),n={};t&&(k(t,n,{}),eachProp(n,L))}),eachProp(u,L)),(!l||a)&&h&&(isBrowser||isWebWorker)&&!s&&(s=setTimeout(function(){s=0,A()},50)),t=!1}function O(e){w(b(e[0],null,!0)).init(e[1],e[2])}function M(e,t,n,r){e.detachEvent&&!isOpera?r&&e.detachEvent(r,t):e.removeEventListener(n,t,!1)}function _(e){var t=e.currentTarget||e.srcElement;return M(t,r.onScriptLoad,"load","onreadystatechange"),M(t,r.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}var t,n,r,i,s,o={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},u={},a={},f=[],l={},c={},h=1,p=1,d=[];return i={require:function(e){return T(e)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports=l[e.map.id]={}},module:function(e){return e.module={id:e.map.id,uri:e.map.url,config:function(){return o.config&&o.config[e.map.id]||{}},exports:l[e.map.id]}}},n=function(e){this.events=a[e.id]||{},this.map=e,this.shim=o.shim[e.id],this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},n.prototype={init:function(e,t,n,r){r=r||{};if(this.inited)return;this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.depMaps.rjsSkipMap=e.rjsSkipMap,this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check()},defineDepById:function(e,t){var n;return each(this.depMaps,function(t,r){if(t.id===e)return n=r,!0}),this.defineDep(n,t)},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(this.fetched)return;this.fetched=!0,r.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();T(this,!0)(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))},load:function(){var e=this.map.url;c[e]||(c[e]=!0,r.load(this.map.id,e))},check:function(e){if(!this.enabled||this.enabling)return;var t,n,i=this.map.id,s=this.depExports,o=this.exports,a=this.factory;if(!this.inited)this.fetch();else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(isFunction(a)){if(this.events.error)try{o=r.execCb(i,a,s,o)}catch(f){t=f}else o=r.execCb(i,a,s,o);this.map.isDefine&&(n=this.module,n&&n.exports!==undefined&&n.exports!==this.exports?o=n.exports:o===undefined&&this.usingExports&&(o=this.exports));if(t)return t.requireMap=this.map,t.requireModules=[this.map.id],t.requireType="define",S(this.error=t)}else o=a;this.exports=o,this.map.isDefine&&!this.ignore&&(l[i]=o,req.onResourceLoad&&req.onResourceLoad(r,this.map,this.depMaps)),delete u[i],this.defined=!0,r.waitCount-=1,r.waitCount===0&&(d=[])}this.defining=!1,e||this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}},callPlugin:function(){var e=this.map,t=e.id,n=b(e.prefix,null,!1,!0);E(n,"defined",bind(this,function(n){var i,s,a,f=this.map.name,l=this.map.parentMap?this.map.parentMap.name:null;if(this.map.unnormalized){n.normalize&&(f=n.normalize(f,function(e){return m(e,l,!0)})||""),s=b(e.prefix+"!"+f,this.map.parentMap,!1,!0),E(s,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),a=u[s.id],a&&(this.events.error&&a.on("error",bind(this,function(e){this.emit("error",e)})),a.enable());return}i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(u,function(e){e.map.id.indexOf(t+"_unnormalized")===0&&N(e.map.id)}),S(e)}),i.fromText=function(e,t){var n=useInteractive;n&&(useInteractive=!1),w(b(e)),req.exec(t),n&&(useInteractive=!0),r.completeLoad(e)},n.load(e.name,T(e.parentMap,!0,function(e,t,n){return e.rjsSkipMap=!0,r.require(e,t,n)}),i,o)})),r.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){this.enabled=!0,this.waitPushed||(d.push(this),r.waitCount+=1,this.waitPushed=!0),this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,s,o;if(typeof e=="string"){e=b(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.depMaps.rjsSkipMap),this.depMaps[t]=e,o=i[e.id];if(o){this.depExports[t]=o(this);return}this.depCount+=1,E(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&E(e,"error",this.errback)}n=e.id,s=u[n],!i[n]&&s&&!s.enabled&&r.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=u[e.id];t&&!t.enabled&&r.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),e==="error"&&delete this.events[e]}},r={config:o,contextName:e,registry:u,defined:l,urlFetched:c,waitCount:0,defQueue:f,Module:n,makeModuleMap:b,configure:function(e){e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/");var t=o.pkgs,n=o.shim,i=o.paths,s=o.map;mixin(o,e,!0),o.paths=mixin(i,e.paths,!0),e.map&&(o.map=mixin(s||{},e.map,!0,!0)),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),e.exports&&!e.exports.__buildReady&&(e.exports=r.makeShimExports(e.exports)),n[t]=e}),o.shim=n),e.packages&&(each(e.packages,function(e){var n;e=typeof e=="string"?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),o.pkgs=t),eachProp(u,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=b(t))}),(e.deps||e.callback)&&r.require(e.deps||[],e.callback)},makeShimExports:function(e){var t;return typeof e=="string"?(t=function(){return getGlobal(e)},t.exports=e,t):function(){return e.apply(global,arguments)}},requireDefined:function(e,t){return hasProp(l,b(e,t,!1,!0).id)},requireSpecified:function(e,t){return e=b(e,t,!1,!0).id,hasProp(l,e)||hasProp(u,e)},require:function(t,n,i,s){var o,u,a,c,h;if(typeof t=="string")return isFunction(n)?S(makeError("requireargs","Invalid require call"),i):req.get?req.get(r,t,n):(o=t,s=n,a=b(o,s,!1,!0),u=a.id,hasProp(l,u)?l[u]:S(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+e)));i&&!isFunction(i)&&(s=i,i=undefined),n&&!isFunction(n)&&(s=n,n=undefined),x();while(f.length){h=f.shift();if(h[0]===null)return S(makeError("mismatch","Mismatched anonymous define() module: "+h[h.length-1]));O(h)}return c=w(b(null,s)),c.init(t,n,i,{enabled:!0}),A(),r.require},undef:function(e){x();var t=b(e,null,!0),n=u[e];delete l[e],delete c[t.url],delete a[e],n&&(n.events.defined&&(a[e]=n.events),N(e))},enable:function(e,t){var n=u[e.id];n&&w(e).enable()},completeLoad:function(e){var t,n,r,i=o.shim[e]||{},s=i.exports&&i.exports.exports;x();while(f.length){n=f.shift();if(n[0]===null){n[0]=e;if(t)break;t=!0}else n[0]===e&&(t=!0);O(n)}r=u[e];if(!t&&!l[e]&&r&&!r.inited){if(o.enforceDefine&&(!s||!getGlobal(s))){if(y(e))return;return S(makeError("nodefine","No define call for "+e,null,[e]))}O([e,i.deps||[],i.exports])}A()},toUrl:function(e,t){var n=e.lastIndexOf("."),i=null;return n!==-1&&(i=e.substring(n,e.length),e=e.substring(0,n)),r.nameToUrl(m(e,t&&t.id,!0),i)},nameToUrl:function(e,t){var n,r,i,s,u,a,f,l,c;if(req.jsExtRegExp.test(e))l=e+(t||"");else{n=o.paths,r=o.pkgs,u=e.split("/");for(a=u.length;a>0;a-=1){f=u.slice(0,a).join("/"),i=r[f],c=n[f];if(c){isArray(c)&&(c=c[0]),u.splice(0,a,c);break}if(i){e===i.name?s=i.location+"/"+i.main:s=i.location,u.splice(0,a,s);break}}l=u.join("/"),l+=t||(/\?/.test(l)?"":".js"),l=(l.charAt(0)==="/"||l.match(/^[\w\+\.\-]+:/)?"":o.baseUrl)+l}return o.urlArgs?l+((l.indexOf("?")===-1?"?":"&")+o.urlArgs):l},load:function(e,t){req.load(r,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if(e.type==="load"||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=_(e);r.completeLoad(t.id)}},onScriptError:function(e){var t=_(e);if(!y(t.id))return S(makeError("scripterror","Script error",e,[t.id]))}}}function getInteractiveScript(){return interactiveScript&&interactiveScript.readyState==="interactive"?interactiveScript:(eachReverse(scripts(),function(e){if(e.readyState==="interactive")return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.0.6",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,aps=ap.slice,apsp=ap.splice,isBrowser=typeof window!="undefined"&&!!navigator&&!!document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(e,t,n,r){var i,s,o=defContextName;return!isArray(e)&&typeof e!="string"&&(s=e,isArray(t)?(e=t,t=n,n=r):e=[]),s&&s.context&&(o=s.context),i=contexts[o],i||(i=contexts[o]=req.s.newContext(o)),s&&i.configure(s),i.require(e,t,n)},req.config=function(e){return req(e)},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),addRequireMethods(req),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(e){throw e},req.load=function(e,t,n){var r=e&&e.config||{},i;if(isBrowser)return i=r.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),i.type=r.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),i.attachEvent&&!(i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0)&&!isOpera?(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)):(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;isWebWorker&&(importScripts(n),e.completeLoad(t))},isBrowser&&eachReverse(scripts(),function(e){head||(head=e.parentNode),dataMain=e.getAttribute("data-main");if(dataMain)return cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript),dataMain=dataMain.replace(jsSuffixRegExp,""),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0}),define=function(e,t,n){var r,i;typeof e!="string"&&(n=t,t=e,e=null),isArray(t)||(n=t,t=[]),!t.length&&isFunction(n)&&n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t)),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)})(this);if(typeof requirejs!="undefined"){var __define=define;define=function(){var e=Array.prototype.slice.call(arguments,0);(typeof e[0]!="string"||!requirejs.defined(e[0]))&&__define.apply(null,e)}}(function(e,t,n,r,i){function f(e,t){var n=Function.prototype[e];n?Function.prototype[e]=function(){return n.apply(this,arguments),t.apply(this,arguments),this}:Function.prototype[e]=t}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var s,o,u,a=r.document;f("async",function(){return this._async=!0,this});var l=/^(xaml!)?(.+?)(\.xml)?$/,c=function(e,t){this.$from=e,this.$to=t},h={"http://www.w3.org/1999/xhtml":"js.html","http://www.w3.org/2000/svg":"js.svg"},p=[new c(/^js\/html\/(a)$/,"js/html/A"),new c(/^js\/html\/(input)$/,"js/html/Input"),new c(/^js\/html\/(select)$/,"js/html/Select"),new c(/^js\/html\/(textarea)$/,"js/html/TextArea"),new c(/^js\/html\/(option)$/,"js/html/Option"),new c(/^js\/html\/(.+)$/,"js/html/HtmlElement"),new c(/^js\/svg\/[sS]vg$/,"js/svg/Svg"),new c(/^js\/svg\/(.+)$/,"js/svg/SvgElement")];typeof JSON!="undefined"?n("JSON",function(){return JSON}):t.config({paths:{JSON:"js/lib/json2"},shim:{JSON:{exports:"JSON"}}}),t.config({paths:{json:"js/plugin/json"}});var d={createApplicationContext:function(e,r,i){var s=(new Date).getTime();r=r||{};var a=function(r){r.xamlClasses=r.xamlClasses||[],r.namespaceMap=r.namespaceMap||h,r.rewriteMap=r.rewriteMap||p;var a=t.config(r),f=new g(a,r);n("applicationContext",function(){return f}),typeof JSON!="undefined"&&n("JSON",function(){return JSON}),a(["inherit","underscore","js/core/Stage"],function(t,n,r){o=n,u=r;if(t&&n)if(e){var c=l.exec(e);c?e="xaml!"+c[2]:e=e.replace(/\./g,"/"),a([e],function(e){f.$applicationFactory=e,f.$creationTime=(new Date).getTime()-s,i(null,f)},function(e){i(e)})}else f.$creationTime=(new Date).getTime()-s,i(null,f);else i("inherit or underscore missing")})};Object.prototype.toString.call(r)=="[object String]"?t(["json!"+r],function(e){a(e)}):r.loadConfiguration?(r.baseUrl&&t.config({baseUrl:r.baseUrl}),t(["json!"+r.loadConfiguration],function(e){e=e||{};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);a(e)})):a(r)},bootStrap:function(e,t,n,i,s){n=n||{};if(typeof r!="undefined"&&r.location&&!n.initialHash){var o=r.location.search.replace(/^\?/,"").split("&");for(var u=0;u<o.length;u++){var f=/^([^=]+)=(.*)$/.exec(o[u]);if(f&&f[1]==="fragment"){var l=location.protocol+"//"+location.host+location.pathname;o.splice(u,1),o.length&&(l+="?"+o.join("&")),l+="#"+f[2],r.location=l;return}}}!t&&a&&a.body&&(t=a.body),i=i||"config.json",s=s||function(e){e&&typeof console!="undefined"&&console.error(e.stack||e)};if(!a){s("Document missing");return}if(!t){s("Target missing");return}d.createApplicationContext(e,i,function(e,i){e?s(e):i.createApplicationInstance(r,function(e,r,i){e?s(e):i.start(n,function(e){e?s(e):(r.render(t),s(null,r,i))})},n)})},rewriteMapEntry:c,createQueryString:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},ajax:function(e,t,n){var i={url:e};o.extend(i,d.ajaxSettings,t);if(i.data&&!(o.isString(i.data)||typeof FormData!="undefined"&&i.data instanceof FormData))throw"data must be a string";i.hasContent=!/^(?:GET|HEAD)$/.test(i.type),i.queryParameter&&o.keys(i.queryParameter).length>0&&(i.url+=/\?/.test(i.url)?"&":"?"+this.createQueryString(i.queryParameter));var u=i.xhr();t&&t.xhrCreated instanceof Function&&t.xhrCreated(u),u.open(i.type,i.url,i.async),i.hasContent&&i.contentType!==!1&&(u.setRequestHeader("Content-Type",i.contentType),typeof r=="undefined"&&u.setRequestHeader("Content-Length",i.data?i.data.length.toString():"0"));try{for(var a in i.headers)i.headers.hasOwnProperty(a)&&u.setRequestHeader(a,i.headers[a])}catch(f){}t&&t.xhrBeforeSend instanceof Function&&t.xhrBeforeSend(u),u.send(i.data);var l=function(e,t){var r;l&&(t||u.readyState===4)&&(l=s,t?u.readyState!==4&&u.abort():r=new m(u),n&&n(t,r))};return!i.async||u.readyState===4?l():u.onreadystatechange=l,u},instances:[],extendFunctionPrototype:f},v=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,m=function(e){this.xhr=e,this.status=e.status,this.$nativeResponseHeaders=e.getAllResponseHeaders(),this.responses={};var t=e.responseXML;t&&t.documentElement&&(this.responses.xml=t),this.responses.text=e.responseText;try{this.statusText=e.statusText}catch(n){this.statusText=""}};m.prototype.getResponseHeader=function(e){var t;if(!this.$responseHeaders){this.$responseHeaders={};while(t=v.exec(this.$nativeResponseHeaders))this.$responseHeaders[t[1].toLowerCase()]=t[2]}return this.$responseHeaders[e.toLowerCase()]},d.ajaxSettings={type:"GET",contentType:"application/x-www-form-urlencoded",async:!0,xhr:function(){return new i},headers:{},data:null};var g=function(e,t){this.$requirejsCache={},this.$requirejsContext=e,this.$config=t},y;g.prototype.createApplicationInstance=function(e,t,n){n=n||{};var r,i=(new Date).getTime(),s=this.$applicationFactory;e.document?r=e.document:(r=e,e=null);var o=new u(this.$requirejsContext,this,r,e);this.$requirejsContext(["js/core/Application","js/core/HeadManager","js/core/History","js/core/Injection","js/core/InterCommunicationBus","js/core/Bindable"],function(e,u,a,f,l,c){y=y||new l,o.$headManager=new u(r),o.$history=new a;var h=o.$injection=new f(null,null,o);o._addInjectionFactories(h),o.$environment=new c,o.$parameter=n,o.$environmentName=n.environment,h.addInstance(o.$bus),h.addInstance(o.$history),h.addInstance(o.$headManager),h.addInstance(o.$externalInterface),h.addInstance(y),h.addInstance("ENV",o.$environment);var p=new s(null,!1,o,null,null);if(p instanceof e){var d=function(e){e?t&&t(e,o,p):(p.set("ENV",o.$environment),o.$application=p,o._initialize("auto"),p._initialize("auto"),p.$creationTime=(new Date).getTime()-i,t&&t(null,o,p))};p.supportEnvironments?e.setupEnvironment(o.$environment,p._getEnvironment(),p.applicationDefaultNamespace,d):d()}else{var v="mainClass isn't an instance of js.core.Application";if(!t)throw v;t(v)}})},g.prototype.getFqClassName=function(e,t,n){if(n==s||n==null)n=!0;if(e&&t){e=(this.$config.namespaceMap[e]||e).replace(/\./g,"/");var r=[e,t].join("/")}else r=(e||t).replace(/\./g,"/");o.indexOf(this.$config.xamlClasses,r)!==-1&&(r="xaml!"+r);if(n)for(var i=0;i<this.$config.rewriteMap.length;i++){var u=this.$config.rewriteMap[i];if(u instanceof d.rewriteMapEntry&&u.$from.test(r))return r.replace(u.$from,u.$to)}return r},g.prototype.createInstance=function(e,t,n){function i(e,t){function n(){return e.apply(this,t)}return n.prototype=e.prototype,new n}t=t||[];var r;e instanceof Function?(r=e,e=r.prototype.constructor.name):(e=e.replace(/\./g,"/"),this.$requirejsCache[e]?r=this.$requirejsCache[e]:(r=this.$requirejsContext(e),this.$requirejsCache[e]=r)),n=n||e;var s;try{s=i(r,t),s.className=n}catch(o){throw console.warn(["Cannot create instance of '"+e+"'",o,t]),o}return s},g.prototype.ajax=function(e,t,n){!/^http.*$/.test(e)&&this.$config.applicationUrl&&(e=this.$config.applicationUrl+"/"+e),d.ajax(e,t,n)},n("rAppid",[],d),d.defaultNamespaceMap=h,d.defaultRewriteMap=p,d.ApplicationContext=g,d.Rewrite=c,e.rAppid=d})(typeof exports!="undefined"?exports:window,typeof requirejs!="undefined"?requirejs:require("requirejs"),typeof requirejs!="undefined"?define:require("requirejs").define,typeof window!="undefined"?window:exports,typeof window!="undefined"?window.XMLHttpRequest:require("xmlhttprequest").XMLHttpRequest),define("inherit",function(){var e;return function(t,n){e=function(t,n,r,i){var s=Array.prototype.slice.call(arguments);s[0]instanceof Object&&s.unshift(null),s[2]instanceof Function&&s.splice(2,0,null),t=s[0],n=s[1]||{},r=s[2]||{},i=s[3]||Object;var o=function(){if(this.ctor)return this.ctor.apply(this,arguments)};if(i.constructor instanceof Function){function u(){}u.prototype=i.prototype,o.prototype=new u,o.prototype.constructor={name:t},o.prototype.base=i.prototype,o.prototype.factory=o}else o.prototype=i,o.prototype.constructor=n,o.prototype.base=i;for(var a in n)if(n.hasOwnProperty(a)){var f=o.prototype[a];o.prototype[a]=n[a],f instanceof Function&&(o.prototype[a].baseImplementation=f)}for(var l in r)r.hasOwnProperty(l)&&(o[l]=r[l]);return o.prototype.callBase=e.callBase,o},e.callBase=function(){var e=Array.prototype.slice.call(arguments);return e.length===0&&(e=Array.prototype.slice.call(arguments.callee.caller.arguments)),arguments.callee.caller.baseImplementation.apply(this,e)},Function.prototype.inherit=function(t,n,r){var i=Array.prototype.slice.call(arguments);return i[0]instanceof Object&&i.unshift(null),e(i[0],i[1],i[2],this)},Function.prototype.callBase=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(t&&t.base){var n=arguments.callee.caller;return this==n?this.baseImplementation.apply(t,e):this.apply(t,e)}throw"base not definied"},Function.prototype.classof=function(e){if(!e)return!1;if(e instanceof Function)return e===this||this.prototype instanceof e;throw new Error("factory must be a function")},e.Base=e({ctor:function(){}}),n.inherit=e}(this,typeof exports=="undefined"?this:exports),e}),define("flow",function(){return function(e){var t=function(e){this.$context=e||{actions:[],vars:{}}},n=function(){return new t};t.prototype.seq=function(e,t){e instanceof Function&&(t=e,e=null);if(!t)throw"Sequence action not defined";var n=this;return this.$context.actions.push(function(r){var i=!1,s=!1,o=function(t,i,o){!t&&e&&(n.$context.vars[e]=i);if(s)return;s=!0,r(t,o)},u=function(e,t){o(e,t,!1)};u.vars=n.$context.vars;if(t.length){u.end=function(e,t){o(e,t,!0)};try{t.call(u,u)}catch(a){o(a,null)}}else{u.end=function(){i=!0};try{o(null,t.call(u),i)}catch(a){o(a,null,i)}}}),this};var r=function(e,t){if(!t)throw"Parallel action not defined";return function(n,r,i,s){var o=!1,u=function(t,r,o){!t&&e&&(i[e]=r),s(n,t,o)},a=function(e,t){u(e,t,!1)};a.vars=r.vars;if(t.length){a.end=function(e,t){u(e,t,!0)};try{t.call(a,a)}catch(f){u(f,null)}}else{a.end=function(){o=!0};try{u(null,t.call(a),o)}catch(f){u(f,null,o)}}}};t.prototype.par=function(e){if(arguments.length>1)return this.par(Array.prototype.slice.call(arguments)),this;var t=this,n,i;if(e){var s=[];if(e instanceof Array)for(n=0;n<e.length;n++){var o=e[n];s.push(new r(null,o))}else if(e instanceof Function)this.par([e]);else for(i in e)e.hasOwnProperty(i)&&s.push(new r(i,e[i]));s.length>0&&this.$context.actions.push(function(e){(function(e,n){var r={},i,s=function(i,s,o){var u;if(!n)return;if(s||o){var a=n;n=null,a(s,o)}else{var f=e.indexOf(i);if(!(f>=0&&f<e.length)){n("Parallel function returned which wasn't part of this parallel actions"),n=null;return}e.splice(f,1);if(e.length===0){for(u in r)r.hasOwnProperty(u)&&(t.$context.vars[u]=r[u]);n(null,!1),n=null}}},o=e.slice();for(i=0;i<o.length;i++){var u=o[i];u(u,t.$context,r,s)}})(s,e)})}return this},t.prototype.parEach=function(e,t){function i(e,i,s){n&&(s=i,i=e,e=null);var o;t.length>=3?o=function(e){this.key=s,t.call(this,i,s,e)}:t.length==2?o=function(e){this.key=s,t.call(this,i,e)}:o=function(){return this.key=s,t.call(this,i)},n?r.push(o):r[e]=o}e=e||[];if(t instanceof Function){var n=e instanceof Array,r=n?[]:{};if(n)for(var s=0;s<e.length;s++)i(e[s],s);else for(var o in e)e.hasOwnProperty(o)&&i(o,e[o],o);return this.par(r)}throw"2nd argument for parEach needs to be a function"},t.prototype.seqEach=function(e,t){function r(e,r){var i;t.length>=3?i=function(n){this.key=r,t.call(this,e,r,n)}:t.length==2?i=function(n){this.key=r,t.call(this,e,n)}:i=function(){return this.key=r,t.call(this,e)},n.seq(i)}e=e||[];if(e instanceof Array){if(t instanceof Function){var n=this;for(var i=0;i<e.length;i++)r(e[i],i);return this}throw"2nd argument for parEach needs to be a function"}throw"values must be an array"},t.prototype.exec=function(e){function r(e,r){try{n(e,r)}catch(i){if(t.errorHandler)try{t.errorHandler(i)}catch(i){}}}function i(e){e<t.$context.actions.length?t.$context.actions[e](function(n,s){n||s?r(n,t.$context.vars):i(e+1)}):r(null,t.$context.vars)}var t=this,n=function(t,n){e&&e(t,n)};i(0)};if(typeof console!="undefined"&&console){var i=console.warn||console.log;i instanceof Function&&(t.prototype.errorHandler=function(e){e instanceof Error?i.call(console,[e.message,e.stack]):i.call(console,e)})}var s=e.flow;n.noConflict=function(){return e.flow=s,n},e.flow=n,e.Flow=t}(typeof exports=="undefined"?this:exports),flow}),define("Query",function(){return function(e){function i(e){e=e||[];var t,n="",r;for(var s=0;s<e.length;s++){t=e[s];if(t instanceof a)n+=t.operator+":"+i(t.expressions);else if(t instanceof f){r=t.value,r instanceof Array||(r=[r]);var o="";for(var u=0;u<r.length;u++)o+=r[u]+":"+typeof r[u];r=o,n+=t.operator+":"+t.field+":"+r+":"}}return n}function s(e){if(e instanceof Array)return e.slice();var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];t[n]=r instanceof Object?s(r):r}return t}var t=function(){return new n},n=function(){this.query={}},r=/^([+-])?(.+)$/;n.prototype={limit:function(e){return this.query.limit=e,this},sort:function(e){function n(e){for(var t=0;t<e.length;t++)i(e[t])}function i(e){if(e instanceof Array)n(e);else if(e instanceof Object){if(!e.hasOwnProperty("field"))throw new Error("Field in sort direction missing");e.direction=e.direction||1,t.push(e)}else{var i=r.exec(e);if(!i)throw new Error("Field cannot be parsed");t.push({direction:i[1]==="-"?-1:1,field:i[2]})}}e=Array.prototype.slice.call(arguments);var t=[];return n(e),this.query.sort=t,this},offset:function(e){return this.query.offset=e,this},toObject:function(){var e={};return this.query.offset&&(e.offset=this.query.offset),this.query.where&&(e.where=this.query.where.toObject()),this.query.limit&&(e.limit=this.query.limit),this.query.sort&&(e.sort=s(this.query.sort)),e},where:function(e){return this.query.where=this.query.where||new a(e),this.query.where},sortCacheId:function(){var e=[];if(this.sort)for(var t=0;t<this.query.sort.length;t++){var n=this.query.sort[t];e.push((n.direction===-1?"-":"+")+n.field)}return e.join(";")},whereCacheId:function(){return this.query.where?this.query.where.operator+":"+i(this.query.where.expressions):""},cacheId:function(){return this.sortCacheId()+":"+this.whereCacheId()},findExpression:function(e,t){function n(r){var i,s=null;for(var o=0;o<r.length;o++){i=r[o],i instanceof a?s=n(i.expressions):i instanceof f&&i.operator==e&&i.field==t&&(s=i);if(s)return s}return s}return this.query.where?n(this.query.where.expressions):null}};var o=["eql","like","lt","lte","gt","gte","in","ne"],u=["not","and","or"],a=function(e){this.operator=e||"and",this.expressions=[]},f=function(e,t,n,r){this.operator=e,this.field=t,this.value=n,r&&(this.type=r)};a.prototype.push=function(e){this.expressions.push(e)},a.prototype.toObject=function(){var e=[],t;for(var n=0;n<this.expressions.length;n++)t=this.expressions[n],t instanceof a?e.push(t.toObject()):e.push(s(t));return{operator:this.operator,expressions:e}},f.prototype={getValue:function(){return this.value}};for(var l=0;l<o.length;l++)(function(e){a.prototype[e]=function(t,n,r){if(t instanceof Object)for(var i in t)t.hasOwnProperty(i)&&this[e](i,t[i]);else this.expressions.push(new f(e,t,n,r));return this},n.prototype[e]=function(){var t=Array.prototype.slice.call(arguments),n=this.where();return n[e].apply(n,t),this}})(o[l]);for(var c=0;c<u.length;c++)(function(e){a.prototype[e]=function(){var t=Array.prototype.slice.call(arguments),n=new a(e);for(var r=0;r<t.length;r++){var i=t[r],s;i instanceof a?s=i:(s=new a,i.call(s,s)),n.expressions.push(s)}this.expressions.push(n)},n.prototype[e]=function(){var t=Array.prototype.slice.call(arguments),n=this.where();return n[e].apply(n,t),this}})(u[c]);var h=e.query;t.noConflict=function(){return e.query=h,t},n.Where=a,n.Comparator=f,e.query=t,e.Query=n}(typeof exports=="undefined"?this:exports),Query}),define("underscore",function(){return function(){function C(e,t,n){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual&&S.isFunction(e.isEqual))return e.isEqual(t);if(t.isEqual&&S.isFunction(t.isEqual))return t.isEqual(e);var r=a.call(e);if(r!=a.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var i=n.length;while(i--)if(n[i]==e)return!0;n.push(e);var s=0,o=!0;if(r=="[object Array]"){s=e.length,o=s==t.length;if(o)while(s--)if(!(o=s in e==s in t&&C(e[s],t[s],n)))break}else{if("constructor"in e!="constructor"in t||e.constructor!=t.constructor)return!1;for(var u in e)if(S.has(e,u)){s++;if(!(o=S.has(t,u)&&C(e[u],t[u],n)))break}if(o){for(u in t)if(S.has(t,u)&&!(s--))break;o=!s}}return n.pop(),o}var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.slice,u=r.unshift,a=i.toString,f=i.hasOwnProperty,l=r.forEach,c=r.map,h=r.reduce,p=r.reduceRight,d=r.filter,v=r.every,m=r.some,g=r.indexOf,y=r.lastIndexOf,b=Array.isArray,w=Object.keys,E=s.bind,S=function(e){return new P(e)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.3.3";var x=S.each=S.forEach=function(e,t,r){if(e==null)return;if(l&&e.forEach===l)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(i in e&&t.call(r,e[i],i,e)===n)return}else for(var o in e)if(S.has(e,o)&&t.call(r,e[o],o,e)===n)return};S.map=S.collect=function(e,t,n){var r=[];return e==null?r:c&&e.map===c?e.map(t,n):(x(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),e.length===+e.length&&(r.length=e.length),r)},S.reduce=S.foldl=S.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(h&&e.reduce===h)return r&&(t=S.bind(t,r)),i?e.reduce(t,n):e.reduce(t);x(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},S.reduceRight=S.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduceRight===p)return r&&(t=S.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=S.toArray(e).reverse();return r&&!i&&(t=S.bind(t,r)),i?S.reduce(s,t,n,r):S.reduce(s,t)},S.find=S.detect=function(e,t,n){var r;return T(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},S.filter=S.select=function(e,t,n){var r=[];return e==null?r:d&&e.filter===d?e.filter(t,n):(x(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},S.reject=function(e,t,n){var r=[];return e==null?r:(x(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},S.every=S.all=function(e,t,r){var i=!0;return e==null?i:v&&e.every===v?e.every(t,r):(x(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var T=S.some=S.any=function(e,t,r){t||(t=S.identity);var i=!1;return e==null?i:m&&e.some===m?e.some(t,r):(x(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};S.include=S.contains=function(e,t){var n=!1;return e==null?n:g&&e.indexOf===g?e.indexOf(t)!=-1:(n=T(e,function(e){return e===t}),n)},S.invoke=function(e,t){var n=o.call(arguments,2);return S.map(e,function(e){return(S.isFunction(t)?t||e:e[t]).apply(e,n)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.max=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-Infinity;var r={computed:-Infinity};return x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},S.min=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return Infinity;var r={computed:Infinity};return x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},S.shuffle=function(e){var t=[],n;return x(e,function(e,r,i){n=Math.floor(Math.random()*(r+1)),t[r]=t[n],t[n]=e}),t},S.sortBy=function(e,t,n){var r=S.isFunction(t)?t:function(e){return e[t]};return S.pluck(S.map(e,function(e,t,i){return{value:e,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n===void 0?1:r===void 0?-1:n<r?-1:n>r?1:0}),"value")},S.groupBy=function(e,t){var n={},r=S.isFunction(t)?t:function(e){return e[t]};return x(e,function(e,t){var i=r(e,t);(n[i]||(n[i]=[])).push(e)}),n},S.sortedIndex=function(e,t,n){n||(n=S.identity);var r=0,i=e.length;while(r<i){var s=r+i>>1;n(e[s])<n(t)?r=s+1:i=s}return r},S.toArray=function(e){return e?S.isArray(e)?o.call(e):S.isArguments(e)?o.call(e):e.toArray&&S.isFunction(e.toArray)?e.toArray():S.values(e):[]},S.size=function(e){return S.isArray(e)?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,n){return t!=null&&!n?o.call(e,0,t):e[0]},S.initial=function(e,t,n){return o.call(e,0,e.length-(t==null||n?1:t))},S.last=function(e,t,n){return t!=null&&!n?o.call(e,Math.max(e.length-t,0)):e[e.length-1]},S.rest=S.tail=function(e,t,n){return o.call(e,t==null||n?1:t)},S.compact=function(e){return S.filter(e,function(e){return!!e})},S.flatten=function(e,t){return S.reduce(e,function(e,n){return S.isArray(n)?e.concat(t?n:S.flatten(n)):(e[e.length]=n,e)},[])},S.without=function(e){return S.difference(e,o.call(arguments,1))},S.uniq=S.unique=function(e,t,n){var r=n?S.map(e,n):e,i=[];return e.length<3&&(t=!0),S.reduce(r,function(n,r,s){if(t?S.last(n)!==r||!n.length:!S.include(n,r))n.push(r),i.push(e[s]);return n},[]),i},S.union=function(){return S.uniq(S.flatten(arguments,!0))},S.intersection=S.intersect=function(e){var t=o.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=S.flatten(o.call(arguments,1),!0);return S.filter(e,function(e){return!S.include(t,e)})},S.zip=function(){var e=o.call(arguments),t=S.max(S.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=S.pluck(e,""+r);return n},S.indexOf=function(e,t,n){if(e==null)return-1;var r,i;if(n)return r=S.sortedIndex(e,t),e[r]===t?r:-1;if(g&&e.indexOf===g)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(r in e&&e[r]===t)return r;return-1},S.lastIndexOf=function(e,t){if(e==null)return-1;if(y&&e.lastIndexOf===y)return e.lastIndexOf(t);var n=e.length;while(n--)if(n in e&&e[n]===t)return n;return-1},S.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var N=function(){};S.bind=function(t,n){var r,i;if(t.bind===E&&E)return E.apply(t,o.call(arguments,1));if(!S.isFunction(t))throw new TypeError;return i=o.call(arguments,2),r=function(){if(this instanceof r){N.prototype=t.prototype;var e=new N,s=t.apply(e,i.concat(o.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(o.call(arguments)))}},S.bindAll=function(e){var t=o.call(arguments,1);return t.length==0&&(t=S.functions(e)),x(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var n={};return t||(t=S.identity),function(){var r=t.apply(this,arguments);return S.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},S.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(o.call(arguments,1)))},S.throttle=function(e,t){var n,r,i,s,o,u,a=S.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&e.apply(n,r),a()};return i||(i=setTimeout(f,t)),s?o=!0:u=e.apply(n,r),a(),s=!0,u}},S.debounce=function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)};n&&!r&&e.apply(i,s),clearTimeout(r),r=setTimeout(o,t)}},S.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments))}},S.wrap=function(e,t){return function(){var n=[e].concat(o.call(arguments,0));return t.apply(this,n)}},S.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},S.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},S.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)S.has(e,n)&&(t[t.length]=n);return t},S.values=function(e){return S.map(e,S.identity)},S.functions=S.methods=function(e){var t=[];for(var n in e)S.isFunction(e[n])&&t.push(n);return t.sort()},S.extend=function(e){return x(o.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},S.pick=function(e){var t={};return x(S.flatten(o.call(arguments,1)),function(n){n in e&&(t[n]=e[n])}),t},S.defaults=function(e){return x(o.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e},S.isEqual=function(e,t){return C(e,t,[])},S.isEmpty=function(e){if(e==null)return!0;if(S.isArray(e)||S.isString(e))return e.length===0;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!!e&&e.nodeType==1},S.isArray=b||function(e){return a.call(e)=="[object Array]"},S.isObject=function(e){return e===Object(e)},S.isArguments=function(e){return a.call(e)=="[object Arguments]"},S.isArguments(arguments)||(S.isArguments=function(e){return!!e&&!!S.has(e,"callee")}),S.isFunction=function(e){return a.call(e)=="[object Function]"},S.isString=function(e){return a.call(e)=="[object String]"},S.isNumber=function(e){return a.call(e)=="[object Number]"},S.isFinite=function(e){return S.isNumber(e)&&isFinite(e)},S.isNaN=function(e){return e!==e},S.isBoolean=function(e){return e===!0||e===!1||a.call(e)=="[object Boolean]"},S.isDate=function(e){return a.call(e)=="[object Date]"},S.isRegExp=function(e){return a.call(e)=="[object RegExp]"},S.isNull=function(e){return e===null},S.isUndefined=function(e){return e===void 0},S.has=function(e,t){return f.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},S.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},S.result=function(e,t){if(e==null)return null;var n=e[t];return S.isFunction(n)?n.call(e):n},S.mixin=function(e){x(S.functions(e),function(t){B(t,S[t]=e[t])})};var k=0;S.uniqueId=function(e){var t=k++;return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var O in A)A[A[O]]=O;var M=/\\|'|\r|\n|\t|\u2028|\u2029/g,_=/\\(\\|'|r|n|t|u2028|u2029)/g,D=function(e){return e.replace(_,function(e,t){return A[t]})};S.template=function(e,t,n){n=S.defaults(n||{},S.templateSettings);var r="__p+='"+e.replace(M,function(e){return"\\"+A[e]}).replace(n.escape||L,function(e,t){return"'+\n_.escape("+D(t)+")+\n'"}).replace(n.interpolate||L,function(e,t){return"'+\n("+D(t)+")+\n'"}).replace(n.evaluate||L,function(e,t){return"';\n"+D(t)+"\n;__p+='"})+"';\n";n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+r+"return __p;\n";var i=new Function(n.variable||"obj","_",r);if(t)return i(t,S);var s=function(e){return i.call(this,e,S)};return s.source="function("+(n.variable||"obj")+"){\n"+r+"}",s},S.chain=function(e){return S(e).chain()};var P=function(e){this._wrapped=e};S.prototype=P.prototype;var H=function(e,t){return t?S(e).chain():e},B=function(e,t){P.prototype[e]=function(){var e=o.call(arguments);return u.call(e,this._wrapped),H(t.apply(S,e),this._chain)}};S.mixin(S),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];P.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);var r=n.length;return(e=="shift"||e=="splice")&&r===0&&delete n[0],H(n,this._chain)}}),x(["concat","join","slice"],function(e){var t=r[e];P.prototype[e]=function(){return H(t.apply(this._wrapped,arguments),this._chain)}}),P.prototype.chain=function(){return this._chain=!0,this},P.prototype.value=function(){return this._wrapped}}.call(this),_}),define("JSON",function(){return define("JSON",[],function(){return JSON}),JSON}),define("json",["JSON"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=function(e,t){throw new Error("Environment unsupported.")},s={},o=/^(.+)\.json$/i;return typeof window!="undefined"&&window.navigator&&window.document||typeof importScripts!="undefined"?(n=function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(t=0;t<3;t++){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}if(!e)throw new Error("getXhr(): XMLHttpRequest not available");return e},i=function(e,t){var r;try{r=n(),r.open("GET",e,!0),r.onreadystatechange=function(){r.readyState===4&&(r.status!==200&&r.status!==304||!r.responseText?t("no responseXML found"):t(null,r.responseText))},r.send(null)}catch(i){t(i)}}):typeof process!="undefined"&&process.versions&&!!process.versions.node&&(t=require.nodeRequire("fs"),i=function(e,n){try{var r=t.readFileSync(e,"utf8");n(null,r)}catch(i){n(i)}}),{write:function(e,t,n){if(t in s){var r=s[t];n.asModule(e+"!"+t,"define(function () { return "+r+";});\n")}},version:"0.1.0",load:function(t,n,r,u){var a=t;t=t.replace(o,"$1"),t+=".json";var f=n.toUrl(t);i(f,function(t,n){t?r.error(new Error("JSON for "+f+" not found")):(u.isBuild&&(s[a]=n),r(e.parse(n)))})}}}),define("json!config.json",[],function(){return{paths:{xaml:"js/plugin/xaml",json:"js/plugin/json",inherit:"js/lib/inherit",underscore:"js/lib/underscore",Query:"js/lib/query/query",flow:"js/lib/flow",raw:"js/plugin/raw",JSON:"js/lib/json2.js",moment:"js/lib/moment","google/plusone":"https://apis.google.com/js/plusone","twitter/widgets":"https://platform.twitter.com/widgets",Piwik:"http://piwik.rappidjs.com/piwik",RestConditionParser:"srv/lib/RestConditionParser"},shim:{inherit:{exports:"inherit"},flow:{exports:"flow"},underscore:{exports:"_"},"google/plusone":{exports:"gapi"},"twitter/widgets":{exports:"twttr"},Piwik:{exports:"Piwik"},"app/lib/highlight/highlight":{exports:"hljs"},"js/lib/parser":{exports:"parser"},Query:{exports:"Query"},JSON:{exports:"JSON"},moment:{exports:"moment"},"md/lib/marked":{exports:"marked"},RestConditionParser:{exports:"parser"}},enableInspection:!0,xamlClasses:["app/Index","app/module/Disclaimer","app/module/Documentation","app/module/Home","app/module/License","app/module/Ui","app/module/Wiki","app/view/MethodView","example/basic/App","example/contact/App","example/contact/view/Card","example/todo/App","example/window/CustomDialog","js/svg/SvgDescriptor","js/ui/ButtonGroup","js/ui/Checkbox","js/ui/ColorPicker","js/ui/DataGrid","js/ui/DataGridColumn","js/ui/DataGridItemsView","js/ui/DatePicker","js/ui/Dialog","js/ui/field/Password","js/ui/field/RadioGroup","js/ui/field/Text","js/ui/field/TextArea","js/ui/Field","js/ui/Link","js/ui/MenuButton","js/ui/ProgressBar","js/ui/Radio","js/ui/Scrollable","js/ui/ScrollView","js/ui/Select","js/ui/SplitButton","js/ui/TabView","js/ui/TileList","js/ui/TreeView","sprd/data/ImageServerDataSource","sprd/data/SprdApiDataSource","sprd/view/ColorSelector","sprd/view/DropDownSizeSelector","sprd/view/Image","sprd/view/ImageUpload","sprd/view/ProductTypeViewSelector","sprd/view/ProductViewer","sprd/view/ProductViewSelector","sprd/view/SimpleProductViewSelector","sprd/view/SizeSelector","sprd/view/svg/ConfigurationViewer","sprd/view/svg/TextConfigurationRenderer","text/ui/SvgTextArea"],namespaceMap:null,rewriteMap:null,optimizedXAML:["app/Index","app/module/Home","app/module/Wiki","app/module/Ui","app/module/Documentation"],baseUrl:"0.7.0-29"}}),define("js/lib/parser",function(){var e=typeof e=="undefined"?this:e;return e.parser=function(){function e(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var t={parse:function(t,n){function a(e,t,n){var r=e,i=n-e.length;for(var s=0;s<i;s++)r=t+r;return r}function f(e){var t=e.charCodeAt(0),n,r;return t<=255?(n="x",r=2):(n="u",r=4),"\\"+n+a(t.toString(16).toUpperCase(),"0",r)}function l(e){if(i<o)return;i>o&&(o=i,u=[]),u.push(e)}function c(){var e,n,r,o,u;o=i,u=i,/^[^\-+{}.,()0-9[\]|]/.test(t.charAt(i))?(e=t.charAt(i),i++):(e=null,s===0&&l("[^\\-+{}.,()0-9[\\]|]"));if(e!==null){n=[],/^[^{}.,()[\]|]/.test(t.charAt(i))?(r=t.charAt(i),i++):(r=null,s===0&&l("[^{}.,()[\\]|]"));while(r!==null)n.push(r),/^[^{}.,()[\]|]/.test(t.charAt(i))?(r=t.charAt(i),i++):(r=null,s===0&&l("[^{}.,()[\\]|]"));n!==null?e=[e,n]:(e=null,i=u)}else e=null,i=u;return e!==null&&(e=function(e,t,n){return t+n.join("")}(o,e[0],e[1])),e===null&&(i=o),e}function h(){var e,n,r,o,u,a;o=i,u=i,t.charCodeAt(i)===39?(e="'",i++):(e=null,s===0&&l('"\'"'));if(e!==null){n=[],a=i,t.length>i?(r=t.charAt(i),i++):(r=null,s===0&&l("any character")),r!==null&&(r=function(e,t){return t==="'"?null:t}(a,r)),r===null&&(i=a);while(r!==null)n.push(r),a=i,t.length>i?(r=t.charAt(i),i++):(r=null,s===0&&l("any character")),r!==null&&(r=function(e,t){return t==="'"?null:t}(a,r)),r===null&&(i=a);n!==null?(t.charCodeAt(i)===39?(r="'",i++):(r=null,s===0&&l('"\'"')),r!==null?e=[e,n,r]:(e=null,i=u)):(e=null,i=u)}else e=null,i=u;return e!==null&&(e=function(e,t){return t.join("")}(o,e[1])),e===null&&(i=o),e}function p(){var e,n,r,o,u;o=i,u=i,t.charCodeAt(i)===45?(e="-",i++):(e=null,s===0&&l('"-"')),e=e!==null?e:"";if(e!==null){/^[0-9]/.test(t.charAt(i))?(r=t.charAt(i),i++):(r=null,s===0&&l("[0-9]"));if(r!==null){n=[];while(r!==null)n.push(r),/^[0-9]/.test(t.charAt(i))?(r=t.charAt(i),i++):(r=null,s===0&&l("[0-9]"))}else n=null;n!==null?e=[e,n]:(e=null,i=u)}else e=null,i=u;return e!==null&&(e=function(e,t,n){return parseInt(n.join(""),10)*(t?-1:1)}(o,e[0],e[1])),e===null&&(i=o),e}function d(){var e,n,r,o,u,a;u=i,a=i,e=p();if(e!==null){t.charCodeAt(i)===46?(n=".",i++):(n=null,s===0&&l('"."'));if(n!==null){/^[0-9]/.test(t.charAt(i))?(o=t.charAt(i),i++):(o=null,s===0&&l("[0-9]"));if(o!==null){r=[];while(o!==null)r.push(o),/^[0-9]/.test(t.charAt(i))?(o=t.charAt(i),i++):(o=null,s===0&&l("[0-9]"))}else r=null;r!==null?e=[e,n,r]:(e=null,i=a)}else e=null,i=a}else e=null,i=a;return e!==null&&(e=function(e,t,n){return parseFloat(t+"."+n.join(""),10)}(u,e[0],e[2])),e===null&&(i=u),e}function v(){var e,n;return n=i,t.substr(i,4)==="true"?(e="true",i+=4):(e=null,s===0&&l('"true"')),e!==null&&(e=function(e){return!0}(n)),e===null&&(i=n),e===null&&(n=i,t.substr(i,5)==="false"?(e="false",i+=5):(e=null,s===0&&l('"false"')),e!==null&&(e=function(e){return!1}(n)),e===null&&(i=n)),e}function m(){var e,n,r,o,u;return o=i,u=i,t.charCodeAt(i)===91?(e="[",i++):(e=null,s===0&&l('"["')),e!==null?(n=p(),n!==null?(t.charCodeAt(i)===93?(r="]",i++):(r=null,s===0&&l('"]"')),r!==null?e=[e,n,r]:(e=null,i=u)):(e=null,i=u)):(e=null,i=u),e!==null&&(e=function(e,t){return t}(o,e[1])),e===null&&(i=o),e}function g(){var e,n,r,o,u,a;u=i,a=i,e=[],t.charCodeAt(i)===32?(n=" ",i++):(n=null,s===0&&l('" "'));while(n!==null)e.push(n),t.charCodeAt(i)===32?(n=" ",i++):(n=null,s===0&&l('" "'));if(e!==null){n=h(),n===null&&(n=v(),n===null&&(n=d(),n===null&&(n=p(),n===null&&(n=N(),n===null&&(n=S())))));if(n!==null){r=[],t.charCodeAt(i)===32?(o=" ",i++):(o=null,s===0&&l('" "'));while(o!==null)r.push(o),t.charCodeAt(i)===32?(o=" ",i++):(o=null,s===0&&l('" "'));r!==null?e=[e,n,r]:(e=null,i=a)}else e=null,i=a}else e=null,i=a;return e!==null&&(e=function(e,t){return t}(u,e[1])),e===null&&(i=u),e}function y(){var e,n,r,o,u,a,f,c;u=i,a=i,e=g();if(e!==null){n=[],f=i,c=i,t.charCodeAt(i)===44?(r=",",i++):(r=null,s===0&&l('","')),r!==null?(o=g(),o!==null?r=[r,o]:(r=null,i=c)):(r=null,i=c),r!==null&&(r=function(e,t){return t}(f,r[1])),r===null&&(i=f);while(r!==null)n.push(r),f=i,c=i,t.charCodeAt(i)===44?(r=",",i++):(r=null,s===0&&l('","')),r!==null?(o=g(),o!==null?r=[r,o]:(r=null,i=c)):(r=null,i=c),r!==null&&(r=function(e,t){return t}(f,r[1])),r===null&&(i=f);n!==null?e=[e,n]:(e=null,i=a)}else e=null,i=a;return e!==null&&(e=function(e,t,n){t&&t.name==="null"&&(t=null);for(var r=0;r<n.length;r++)n[r]&&n[r][0]&&n[r][0].name==="null"&&(n[r]=null);return typeof t!="undefined"?[t].concat(n):[]}(u,e[0],e[1])),e===null&&(i=u),e===null&&(u=i,e="",e!==null&&(e=function(e){return[]}(u)),e===null&&(i=u)),e}function b(){var e,t,n,r;return n=i,r=i,e=c(),e!==null?(t=m(),t=t!==null?t:"",t!==null?e=[e,t]:(e=null,i=r)):(e=null,i=r),e!==null&&(e=function(e,t,n){return{name:t,type:"var",index:n}}(n,e[0],e[1])),e===null&&(i=n),e}function w(){var e,n,r,o,u,a,f;return a=i,f=i,e=c(),e!==null?(t.charCodeAt(i)===40?(n="(",i++):(n=null,s===0&&l('"("')),n!==null?(r=y(),r=r!==null?r:"",r!==null?(t.charCodeAt(i)===41?(o=")",i++):(o=null,s===0&&l('")"')),o!==null?(u=m(),u=u!==null?u:"",u!==null?e=[e,n,r,o,u]:(e=null,i=f)):(e=null,i=f)):(e=null,i=f)):(e=null,i=f)):(e=null,i=f),e!==null&&(e=function(e,t,n,r){return{name:t,type:"fnc",parameter:n,index:r}}(a,e[0],e[2],e[4])),e===null&&(i=a),e}function E(){var e,t;return t=i,e=m(),e!==null&&(e=function(e,t){return{type:"index",index:t}}(t,e)),e===null&&(i=t),e===null&&(e=w(),e===null&&(e=b())),e}function S(){var e,n,r,o,u,a,f,c;u=i,a=i,e=E();if(e!==null){n=[],f=i,c=i,t.charCodeAt(i)===46?(r=".",i++):(r=null,s===0&&l('"."')),r!==null?(o=E(),o!==null?r=[r,o]:(r=null,i=c)):(r=null,i=c),r!==null&&(r=function(e,t){return t}(f,r[1])),r===null&&(i=f);while(r!==null)n.push(r),f=i,c=i,t.charCodeAt(i)===46?(r=".",i++):(r=null,s===0&&l('"."')),r!==null?(o=E(),o!==null?r=[r,o]:(r=null,i=c)):(r=null,i=c),r!==null&&(r=function(e,t){return t}(f,r[1])),r===null&&(i=f);n!==null?e=[e,n]:(e=null,i=a)}else e=null,i=a;return e!==null&&(e=function(e,t,n){return[t].concat(n)}(u,e[0],e[1])),e===null&&(i=u),e}function x(){var e,n,r,o,u;return o=i,u=i,t.charCodeAt(i)===123?(e="{",i++):(e=null,s===0&&l('"{"')),e!==null?(n=S(),n!==null?(t.charCodeAt(i)===125?(r="}",i++):(r=null,s===0&&l('"}"')),r!==null?e=[e,n,r]:(e=null,i=u)):(e=null,i=u)):(e=null,i=u),e!==null&&(e=function(e,t){return t?{path:t,type:"normal"}:!1}(o,e[1])),e===null&&(i=o),e}function T(){var e,n,r,o,u,a,f,c,h;return a=i,f=i,t.substr(i,2)==="{{"?(e="{{",i+=2):(e=null,s===0&&l('"{{"')),e!==null?(n=S(),n!==null?(c=i,h=i,t.charCodeAt(i)===124?(r="|",i++):(r=null,s===0&&l('"|"')),r!==null?(o=S(),o!==null?r=[r,o]:(r=null,i=h)):(r=null,i=h),r!==null&&(r=function(e,t){return t}(c,r[1])),r===null&&(i=c),r=r!==null?r:"",r!==null?(c=i,h=i,t.charCodeAt(i)===124?(o="|",i++):(o=null,s===0&&l('"|"')),o!==null?(u=S(),u!==null?o=[o,u]:(o=null,i=h)):(o=null,i=h),o!==null&&(o=function(e,t){return t}(c,o[1])),o===null&&(i=c),o=o!==null?o:"",o!==null?(t.substr(i,2)==="}}"?(u="}}",i+=2):(u=null,s===0&&l('"}}"')),u!==null?e=[e,n,r,o,u]:(e=null,i=f)):(e=null,i=f)):(e=null,i=f)):(e=null,i=f)):(e=null,i=f),e!==null&&(e=function(e,t,n,r){return t?{path:t,type:"twoWay",transform:n||!1,transformBack:r||!1}:!1}(a,e[1],e[2],e[3])),e===null&&(i=a),e}function N(){var e,n,r,o;return r=i,o=i,t.charCodeAt(i)===36?(e="$",i++):(e=null,s===0&&l('"$"')),e!==null?(n=x(),n!==null?e=[e,n]:(e=null,i=o)):(e=null,i=o),e!==null&&(e=function(e,t){return t.type="static",t}(r,e[1])),e===null&&(i=r),e}function C(){var e,n,r;r=i,e=T(),e!==null&&(e=function(e,t){return[t]}(r,e)),e===null&&(i=r);if(e===null){e=[],n=N(),n===null&&(n=x(),n===null&&(t.length>i?(n=t.charAt(i),i++):(n=null,s===0&&l("any character"))));while(n!==null)e.push(n),n=N(),n===null&&(n=x(),n===null&&(t.length>i?(n=t.charAt(i),i++):(n=null,s===0&&l("any character"))))}return e}function k(){var e;return e=w(),e===null&&(e=b()),e}function L(e){e.sort();var t=null,n=[];for(var r=0;r<e.length;r++)e[r]!==t&&(n.push(e[r]),t=e[r]);return n}function A(){var e=1,n=1,r=!1;for(var s=0;s<Math.max(i,o);s++){var u=t.charAt(s);u==="\n"?(r||e++,n=1,r=!1):u==="\r"||u==="\u2028"||u==="\u2029"?(e++,n=1,r=!0):(n++,r=!1)}return{line:e,column:n}}var r={varName:c,string:h,number:p,"float":d,"boolean":v,index:m,parameter:g,parameterArray:y,"var":b,fnc:w,pathElement:E,path:S,binding:x,twoWayBinding:T,staticBinding:N,text:C,eventHandler:k};if(n!==undefined){if(r[n]===undefined)throw new Error("Invalid rule name: "+e(n)+".")}else n="text";var i=0,s=0,o=0,u=[],O=r[n]();if(O===null||i!==t.length){var M=Math.max(i,o),_=M<t.length?t.charAt(M):null,D=A();throw new this.SyntaxError(L(u),_,M,D.line,D.column)}return O},toSource:function(){return this._source}};return t.SyntaxError=function(t,n,r,i,s){function o(t,n){var r,i;switch(t.length){case 0:r="end of input";break;case 1:r=t[0];break;default:r=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return i=n?e(n):"end of input","Expected "+r+" but "+i+" found."}this.name="SyntaxError",this.expected=t,this.found=n,this.message=o(t,n),this.offset=r,this.line=i,this.column=s},t.SyntaxError.prototype=Error.prototype,t}(),parser}),define("js/core/Base",["inherit"],function(e){var t=0,n=function(){},r=e.Base.inherit("js.core.Base",{ctor:function(){this.$debounceTimeoutMap={},this.$cid=++t},runsInBrowser:function(){return typeof window!="undefined"},emptyCallback:function(){return n},log:function(e,t){t=t||r.LOGLEVEL.INFO,e instanceof Error&&(e=e.toString()+(e.stack||""));if(r.logger.length)for(var n=0;n<r.logger.length;n++)r.logger[n].log(e,t);else if(typeof console!="undefined"){var i=console[t]||console.log;if(i)try{i.call(console,"[ "+new Date+" ]: ",e)}catch(s){}}},_debounceFunctionCall:function(e,t,n,r,i,s){var o=this,u="loop";if(!e)return;t=t||e.toString(),r=r||this,i=i||[],s=s||u;if(n===0){e.apply(r,i);return}n=n||300;if(this.$debounceTimeoutMap[t]){if(s===u)return;clearTimeout(this.$debounceTimeoutMap[t])}this.$debounceTimeoutMap[t]=setTimeout(function(){delete o.$debounceTimeoutMap[t],e.apply(r,i)},n)}});return r.logger=[],r.LOGLEVEL={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"},r}),define("js/core/EventDispatcher",["js/core/Base","rAppid"],function(e,t){t.extendFunctionPrototype("on",function(){var e=Array.prototype.slice.call(arguments);this._events=this._events||[];for(var t=0;t<e.length;t++){var n=e[t];this._events.push(n)}return this.trigger||(this.trigger=function(){}),this}),t.extendFunctionPrototype("onChange",function(){var e=Array.prototype.slice.call(arguments);this._events=this._events||[],this._attributes=this._attributes||[];var t;for(var n=0;n<e.length;n++)t=e[n],this._attributes.push(t);return this.trigger||(this.trigger=function(){}),this}),t.extendFunctionPrototype("bus",function(){var e=Array.prototype.slice.call(arguments);this._busEvents=this._busEvents||[];for(var t=0;t<e.length;t++)this._busEvents.push(e[t]);return this});var n,r=e.inherit("js.core.EventDispatcher",{ctor:function(){this.callBase(),this._eventHandlers={}},bind:function(e,t,n){if(t){n=n||this;var i=this._eventHandlers[e]||(this._eventHandlers[e]=[]);t instanceof r.EventHandler?i.push(t):i.push(new r.EventHandler(t,n))}else this.log('no eventHandler for "'+e+'"',"warn");return this},trigger:function(e,t,i){t instanceof r.Event||(t=new r.Event(t)),t.target||(t.target=i||this),t.type=e;if(!this._eventHandlers[e]&&!this._eventHandlers["*"])return t;var s,o,u;if(this._eventHandlers[e]){s=this._eventHandlers[e].slice();for(u=0;u<s.length;u++)if(s[u]){o=s[u].trigger(t,t.target),o!==n&&o===!1&&(t.preventDefault(),t.stopPropagation());if(t.isImmediatePropagationStopped)break}}if(this._eventHandlers["*"]){s=this._eventHandlers["*"].slice();for(u=0;u<s.length;u++)if(s[u]){o=s[u].trigger(t,i),o!==n&&o===!1&&(t.preventDefault(),t.stopPropagation());if(t.isImmediatePropagationStopped)break}}return t},unbind:function(e,t,n){if(!e)this._eventHandlers={};else if(!t)this._eventHandlers[e]=[];else if(this._eventHandlers[e]){var r=this._eventHandlers[e];for(var i=r.length-1;i>=0;i--)r[i].$callback==t&&(!n||n===r[i].scope)&&r.splice(i,1)}},destroy:function(){if(this.$destroyed)return;this._beforeDestroy(),this._innerDestroy(),this._destroyCompleted()},_beforeDestroy:function(){},_innerDestroy:function(){},_destroyCompleted:function(){this.$destroyed=!0,this.trigger("destroy"),this._eventHandlers={}}});return r.Event=e.inherit({ctor:function(e,t){this.$=e,this.target=t,this.isDefaultPrevented=!1,this.isPropagationStopped=!1,this.isImmediatePropagationStopped=!1},preventDefault:function(){this.isDefaultPrevented=!0;if(this.$){var e=this.$.orginalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}},stopPropagation:function(){this.isPropagationStopped=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=!0,this.stopPropagation()}}),r.EventHandler=e.inherit("js.core.EventDispatcher.EventHandler",{ctor:function(e,t){this.scope=t,this.$callback=e},trigger:function(e,t){return this.$callback.call(this.scope,e,t),!e.isPropagationStopped}}),r}),define("js/core/Bus",["js/core/EventDispatcher"],function(e){var t=e.inherit("js.core.Bus",{ctor:function(e){this.callBase(),this.$stage=e,this.bind(t.Event.SET_UP,this._setUpBindable,this),this.bind(t.Event.TEAR_DOWN,this._tearDownBindable,this)},setUp:function(e){if(e.$stage)return;e.$stage=this.$stage,e._setUp()},tearDown:function(e){if(!e.$stage)return;e._tearDown(),e.$stage=null},_setUpBindable:function(e){this.setUp(e.$)},_tearDownBindable:function(e){this.tearDown(e.$)}});return t.Event={SET_UP:"Bindable.SetUp",TEAR_DOWN:"Bindable.TearDown"},t}),define("js/core/Binding",["js/core/EventDispatcher","js/lib/parser","underscore"],function(e,t,n){var r=function(e){var t=[];for(var n=0;n<e.length;n++){var r=e[n];if(r.type!=f)return!1;t.push(r.name)}return t.join(".")},i=0,s,o,u=e.inherit("js.core.Binding",{defaults:{event:"change",path:null,twoWay:!1},ctor:function(e){if(!o)try{o=requirejs("js/core/Bindable")}catch(t){o=null}this.callBase(),this.$targets=[],this.$=e,n.defaults(this.$,this.defaults),this.initialize()},transform:function(e){return e},transformBack:function(e){return e},initialize:function(){this._checkAttributes(),this.$parameters=[],this.$events=[],this.$subBinding=null,this.$.rootScope||(this.$.rootScope=this);var e=this.$.scope;n.isString(this.$.path)&&(this.$.path=t.parse(this.$.path,"path")),this.$.key=this.$.path[0];var r=this;this.$.parent||(e.bind("destroy",this.destroy,this),this.$.root=this);if(this.$.key.type==a){var i=this.$.key.name,s=this.$.key.parameter;if(n.isFunction(e[i])){var o=e[i],u=[];o._attributes=this._getOnChangeAttributesForFnc(e,o),o._attributes&&o._attributes.length>0&&(this.$.scope.bind("change",this._changeCallback,this),this.$events.push({eventType:"change",callback:this._changeCallback}));var f=function(){r._callback()},c;for(var h=0;h<o._attributes.length;h++)c=o._attributes[h],c.indexOf(".")>-1&&(c=t.parse(c,"path"),this.$.bindingCreator.create({scope:this.$.scope,path:c,type:l,parent:null},this.$.target,f));o._events=this._getEventsForFnc(e,o),o._events?u=o._events:u=[];var p;for(var d=0;d<u.length;d++)p=u[d],e.bind(p,this._callback,this),this.$events.push({eventType:p,callback:this._callback});var v;this.$parameters=[];for(var m=0;m<s.length;m++)v=s[m],v instanceof Array&&(v={path:v,type:l,parent:null}),n.isObject(v)&&(v=this.$.bindingCreator.create(v,this.$.target,f)),this.$parameters.push(v);this.$.fnc=o,this.$.fnc.trigger=function(){r.triggerBinding()}}}else this.$.event="change:"+this.$.key.name,this.$events.push({eventType:this.$.event,callback:this._callback}),e.bind(this.$.event,this._callback,this);this.$.twoWay===!0&&(this.$.targetEvent="change:"+this.$.targetKey,this.$.path.length===1&&this.$.target.bind(this.$.targetEvent,this._revCallback,this)),this.$.parent||this.addTarget(this.$.target,this.$.targetKey||this.$.callback),this._createSubBinding()},_getOnChangeAttributesForFnc:function(e,t){var n=[];if(t._attributes&&t._attributes.length>0)for(var r=0;r<t._attributes.length;r++){var i=t._attributes[r],s=/^(.+)\(\)$/,o=s.exec(i);if(o){var u=e[o[1]];u&&(n=n.concat(this._getOnChangeAttributesForFnc(e,u)))}else n.push(i)}return n},_getEventsForFnc:function(e,t){var r=[];if(t._events&&t._events.length>0)for(var i=0;i<t._events.length;i++){var s=t._events[i],o=/^(.+)\(\)$/,u=o.exec(s);if(u){var a=e[u[1]];a&&(r=r.concat(this._getEventsForFnc(e,a)))}else n.contains(r,s)||r.push(s)}return r},_checkAttributes:function(){if(!this.$.path)throw"No path defined!";if(!this.$.scope)throw"No scope defined!";if(this.$.twoWay){if(!this.$.target)throw"TwoWay binding, but no target defined!";if(!this.$.target instanceof o)throw"Target is not a Bindable!";if(!this.$.targetKey)throw"TwoWay binding, but no target key defined!"}this.$.bindingCreator||(this.$.bindingCreator=this),this.transform=this.$.transform||this.transform,this.transformScope=this.$.transformScope||this.$.scope,this.transformBack=this.$.transformBack||this.transformBack,this.transformBackScope=this.$.transformBackScope||this.$.scope},_createSubBinding:function(){if(this.$.path.length>1){var e;this.$.fnc?e=this.getValue():e=this.$.scope.$[this.$.key.name],this.$jsonObject=s,e instanceof o?this.$subBinding=new u({scope:e,path:this.$.path.slice(1),target:this.$.target,targetKey:this.$.targetKey,rootScope:this.$.rootScope,callback:this.$.callback,context:this.$.context,twoWay:this.$.twoWay,transform:this.$.transform,transformScope:this.$.transformScope,transformBack:this.$.transformBack,transformBackScope:this.$.transformBackScope,bindingCreator:this.$.bindingCreator,parent:this,root:this.$.root}):e instanceof Object?this.$jsonObject=e:n.isString(e)&&(this.$jsonObject=e)}},_revCallback:function(e){if(this.$.fnc){var t=this._getFncParameters();t.unshift(e.$),this.$.fnc.apply(this.$.scope,t)}else this.$.scope.set(r(this.$.path),this.transformBack.call(this.transformBackScope,e.$,this.$originalValue))},_changeCallback:function(e){if(!this.$)return;for(var t=0;t<this.$.fnc._attributes.length;t++)if(!n.isUndefined(e.$[this.$.fnc._attributes[t]])){this._callback();return}},_callback:function(){if(!this.$)return;this.invalidateValueCache(),this.$subBinding&&(this.$subBinding.destroy(),this.$subBinding=null),this._createSubBinding(),this.triggerBinding()},_innerDestroy:function(){if(!this.$)return;var e;for(var t=0;t<this.$events.length;t++)e=this.$events[t],this.$.scope.unbind(e.eventType,e.callback,this);this.$.scope.unbind("destroy",this.destroy,this),this.$.twoWay===!0&&this.$.target.unbind(this.$.targetEvent,this._revCallback,this),this.$subBinding&&(this.$subBinding.destroy(),this.$subBinding=null);for(var n=0;n<this.$parameters.length;n++){var r=this.$parameters[n];r instanceof u&&r.destroy()}this.$parameters=null,this.$.scope=this.$.target=this.$.callback=null,this.$=null,this.$targets=null,this.callBase(),i++,i===500&&(typeof CollectGarbage=="function"&&CollectGarbage(),i=0)},_getFncParameters:function(){var e=[];for(var t=0;t<this.$parameters.length;t++){var n=this.$parameters[t];n instanceof u&&(n=n.getValue()),e.push(n)}return e},getValue:function(){return this.$subBinding?(this.$subBinding.invalidateValueCache(),this.$subBinding.getValue()):this.$cachedValue!==s&&!this.$jsonObject?this.$cachedValue:(this.$originalValue=s,this.$.fnc&&!this.$jsonObject?this.$originalValue=this.$.fnc.apply(this.$.scope,this._getFncParameters()):this.$.path.length===1?this.$originalValue=this.$.scope.get(this.$.key.name):this.$jsonObject&&!n.isString(this.$jsonObject)&&(this.$originalValue=this.$.scope.get(this.$jsonObject,this.$.path.slice(1))),this.$cachedValue=this.transform.call(this.transformScope,this.$originalValue),this.$cachedValue)},invalidateValueCache:function(){this.$cachedValue=s},getContextValue:function(){return this.$.context&&this.$.context.length>1?u.contextToString(this.$.context):this.getValue()},triggerBinding:function(){var e=this.getContextValue(),t,n=this.$.root.getTargets();if(n)for(var r=0;r<n.length;r++)t=n[r],t.key instanceof Function?t.key.call(t.scope,e,this):t.scope.set(t.key,e)},toString:function(){return this.getValue()},getTargets:function(){return this.$targets},addTarget:function(e,t){e.bind("destroy",function(){this.removeTarget(e,t)},this),this.$targets.push({scope:e,key:t})},removeTarget:function(e,t){var n;if(this.$targets){for(var r=0;r<this.$targets.length;r++){n=this.$targets[r];if(n.key===t&&n.scope===e){this.$targets.splice(r,1);break}}this.$targets.length===0&&this.destroy()}},create:function(e,t,n){var r={scope:this.$.scope,target:t,callback:n,path:e.path,parent:e.parent,twoWay:e.type===h,bindingCreator:this.$.bindingCreator},i,s;return e.transform&&(i=e.transform.pop(),s=this.get(e.transform),s&&(r.transform=s[i.name])),e.transformBack&&(i=e.transformBack.pop(),s=this.get(e.transform),s&&(r.transformBack=s[i.name])),new u(r)}}),a=u.TYPE_FNC="fnc",f=u.TYPE_VAR="var",l=u.TYPE_NORMAL="normal",c=u.TYPE_STATIC="static",h=u.TYPE_TWOWAY="twoWay";return u.contextToString=function(e){var t="",n;for(var r=0;r<e.length;r++)n=e[r],n instanceof u&&(n=n.getValue()),n!==null&&typeof n!="undefined"&&(t+=n);return t},u}),define("js/core/BindingCreator",["js/core/EventDispatcher","js/lib/parser","js/core/Binding","underscore"],function(e,t,n,r){function i(e,t){var r=e[0];r.type==n.TYPE_FNC?t=t.getScopeForFncName(r.name):t=t.getScopeForKey(r.name);var i=t;while(i&&e.length>0){r=e.shift();if(r.type==n.TYPE_FNC)return i[r.name];r.type==n.TYPE_VAR&&(i=i.get(r.name))}return!1}function u(e){if(e instanceof Array){var t=[];for(var r=0;r<e.length;r++)e[r].type===n.TYPE_VAR?t.push(e[r].name):e[r].type===n.TYPE_FNC&&t.push(e[r].name+"("+o++ +")");return t.join(".")}return e}var s={},o=0;return e.inherit("js.core.BindingCreator",{create:function(e,t,i,o){var a=e.path,f=a[0],l,c=t;f.type!=n.TYPE_FNC&&i==f.name&&(c=c.$parentScope),f.type==n.TYPE_FNC?l=c.getScopeForFncName(f.name):l=c.getScopeForKey(f.name);if(l){if(e.type!=="static"){var h;r.isFunction(i)&&(h=i);var p=e.type==n.TYPE_TWOWAY,d,v=!h&&!p&&o&&o.length===1&&o[0]instanceof Object;if(v){d=u(e.path)+"_"+l.$cid+"_"+(e.transform?e.transform.join("."):"")+"_"+(e.transformBack?e.transformBack.join("."):"");if(s[d])return s[d].addTarget(t,i),s[d]}var m={scope:l,path:a,parent:e.parent,target:t,twoWay:p,context:o,bindingCreator:this};if(p){var g,y;e.transform&&e.transform.length&&(g=e.transform[0].name,y=c.getScopeForFncName(g),y&&y[g]instanceof Function&&(m.transform=y[g],m.transformScope=y)),e.transformBack&&e.transformBack.length&&(g=e.transformBack[0].name,y=c.getScopeForFncName(g),y&&y[g]instanceof Function&&(m.transformBack=y[g],m.transformBackScope=y))}h?m.callback=h:m.targetKey=i;var b=new n(m);return v&&(b.bind("destroy",function(){delete s[d]}),s[d]=b),b}var w;function E(e,t){return S(t),e.get(t)}function S(e){var t,n,i;for(var s=0;s<e.length;s++){t=e[s];if(r.isObject(t)&&t.type==="fnc")for(var o=0;o<t.parameter.length;o++)w=t.parameter[o],r.isArray(w)&&(n=w[0],n.type==="var"?i=c.getScopeForKey(n.name):n.type==="fnc"&&(i=c.getScopeForKey(n.name)),i&&(t.parameter[o]=E(i,w)))}}return S(e.path),l.get(e.path)}throw new Error("Couldn't find scope for "+f.name)},evaluate:function(e,t,i,s){if(!r.isString(e))return e;s=s||this.parse(e);var o,u=[];for(var a=0;a<s.length;a++){var f=s[a];if(f.length)s[a]=f;else{try{o=this.create(f,t,i,s)}catch(l){throw new Error("Create binding for '"+e+"'. "+l.message)}o instanceof n&&(u.push(o),t.$bindings[i]=t.$bindings[i]||[],t.$bindings[i].push(o)),s[a]=o}}return u.length>0?u[0].getContextValue():s.length>0?s.length===1?s[0]:n.contextToString(s):e},parse:function(e){if(r.isString(e))return t.parse(e,"text")},parsePath:function(e){return t.parse(e,"path")},containsBindingDefinition:function(e){if(e)for(var t=0;t<e.length;t++)if(e[t]instanceof Object)return!0;return!1}})}),define("js/core/Bindable",["js/core/EventDispatcher","js/lib/parser","js/core/Binding","underscore","js/core/BindingCreator"],function(e,t,n,r,i){var s,o,u,a=function(){var e,t=[],n=function(){for(var n=0;n<t.length;n++)try{t[n]()}catch(r){(console.warn||console.log).call(console,r)}t=[],e=null};return{addCallback:function(r){t.push(r),e||(e=setTimeout(n,1e3/60))}}}(),f=function(e,t){if(e===t)return!0;if(e instanceof o&&t instanceof o)return e.isDeepEqual(t);if(e instanceof o||t instanceof o)return!1;if(r.isArray(e)&&r.isArray(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!f(e[n],t[n]))return!1;return!0}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(r.isObject(e)&&r.isObject(t)){if(r.size(e)!==r.size(t))return!1;for(var i in e)if(e.hasOwnProperty(i)&&t.hasOwnProperty(i)&&!f(e[i],t[i]))return!1;return!0}return r.isEqual(e,t)},l=function(t,n){return t instanceof e||n instanceof e?t===n:r.isEqual(t,n)};return o=e.inherit("js.core.Bindable",{ctor:function(e,t){s=s||new i,this.$eventBindables=[],this.$bindings={},this.$bindingCreator=s,this.callBase(null),this.$={},this.$bindingAttributes={},this.$invalidatedProperties={},this.$invalidated=!1,r.extend(this._eventAttributes,this.base._eventAttributes||{}),e=e||{};var n=this._defaultAttributes(),o,u={};if(!t)for(var a in e)e.hasOwnProperty(a)&&r.isString(e[a])&&(h=s.parse(e[a]),s.containsBindingDefinition(h)&&(u[a]=!0));for(var f in n)n.hasOwnProperty(f)&&(o=n[f],e.hasOwnProperty(f)||(r.isFunction(o)?e[f]=new o:n[f]instanceof RegExp?e[f]=o:e[f]=r.clone(o)));this.$=e;var l=this.$,c=this.$bindingAttributes,h,p;for(f in l)l.hasOwnProperty(f)&&!u.hasOwnProperty(f)&&(p=l[f],h=s.parse(p),s.containsBindingDefinition(h)&&(c[f]={bindingDefinitions:h,value:p},l[f]=null));this.$previousAttributes={},this._initializeFromCtor()},inject:{},_initializeFromCtor:function(){this._initialize()},_initialize:function(){if(this.$initialized)return;this.$initializing=!0,this.initialize(),this._initializeBindings()},initialize:function(){},_injectChain:function(){return this._generateDefaultsChain("inject")},_setUp:function(){this._inject(),this._bindBus()},_tearDown:function(){this._extract(),this._unbindBus()},_inject:function(){var e=this._injectChain();if(r.keys(e).length>0){var t=this.$stage.$injection;if(!t)throw"injection not available in systemManager";for(var n in e)if(e.hasOwnProperty(n))try{this.$[n]=t.getInstance(e[n])}catch(i){throw r.isString(i)&&(i=new Error(i+" for key '"+n+"'")),i}}this._postConstruct()},_bindBus:function(){for(var e in this){var t=this[e];if(t instanceof Function&&t._busEvents)for(var n=0;n<t._busEvents.length;n++)this.$stage.$bus.bind(t._busEvents[n],t,this)}},_unbindBus:function(){for(var e in this){var t=this[e];if(t instanceof Function&&t._busEvents)for(var n=0;n<t._busEvents.length;n++)this.$stage.$bus.unbind(t._busEvents[n],t,this)}},_extract:function(){this._preDestroy();var e=this._injectChain();if(r.keys(e).length>0)for(var t in e)e.hasOwnProperty(t)&&(this.$[t]=null)},_initializeBindings:function(){if(this.$initialized)return;var e=this.$,t=this.$bindingCreator,n=this.$bindingAttributes,r,i,s,o;for(o in n)n.hasOwnProperty(o)&&(i=n[o],i?(s=i.value,r=i.bindingDefinitions,e[o]=t.evaluate(s,this,o,r)):(s=e[o],r=null));if(this.$errorAttribute&&this.$bindings[this.$errorAttribute]){var u=this.$bindings[this.$errorAttribute][0],a;if(u.$.path.length>1){var f=u.$.path.slice(),l=f.pop().name;f=f.concat(t.parsePath("errors()."+l)),a=t.create({type:"oneWay",path:f},this,"$error"),a&&(e.$error=a.getValue())}}this._initializeBindingsBeforeComplete(),this._initializationComplete()},_initializeBindingsBeforeComplete:function(){},_initializationComplete:function(){this.set(this.$,{force:!0,silent:!1,initial:!0}),this.$initialized=!0,this.$initializing=!1},_postConstruct:function(){},_preDestroy:function(){},getScopeForKey:function(e){if(this.$.hasOwnProperty(e))return this;if(!this.$parentScope)return null;if(this.$parentScope.$rootScope===this.$rootScope)return this.$parentScope.getScopeForKey(e);if(this.$parentScope.$.hasOwnProperty(e))return this.$parentScope},getScopeForFncName:function(e){var t=this[e];if(t instanceof Function)return this;if(!this.$parentScope)return null;if(this.$parentScope.$rootScope===this.$rootScope)return this.$parentScope.getScopeForFncName(e);if(this.$parentScope[e]instanceof Function)return this.$parentScope},defaults:{},sync:function(){if(this._$source){var e,t={},n={};for(var r in this.$)this.$.hasOwnProperty(r)&&(e=this.$[r],e instanceof o&&e.sync()?t[r]=e._$source:t[r]=e);for(var i in this._$source.$)this._$source.$.hasOwnProperty(i)&&(t.hasOwnProperty(i)||(n[i]=""));return this._$source.set(n,{unset:!0}),this._$source.set(t),!0}return!1},clone:function(e){var t={};e=e||{},this._generateDefaultsChain();for(var n in this.$)if(this.$.hasOwnProperty(n)){if(e.exclude&&e.exclude instanceof Array&&r.include(e.exclude,n)){t[n]=this.$[n];continue}t[n]=this._cloneAttribute(this.$[n],n)}var i=new this.factory(t);return i._$source=this,i},_cloneAttribute:function(e,t){if(this.inject&&this.inject.hasOwnProperty(t))return e;if(e instanceof o)return e.clone();if(e&&e.clone instanceof Function)return e.clone();if(r.isArray(e)){var n=[];for(var i=0;i<e.length;i++)n.push(this._cloneAttribute(e[i]));return n}if(e instanceof Date)return new Date(e.getTime());if(r.isObject(e)){var s={};for(var u in e)e.hasOwnProperty(u)&&(s[u]=this._cloneAttribute(e[u],u));return s}return e},_defaultAttributes:function(){return this._generateDefaultsChain("defaults")},_generateDefaultsChain:function(e){this.factory.chainCache=this.factory.chainCache||{};if(this.factory.chainCache[e])return this.factory.chainCache[e];var t=this[e],n=this.base;while(n){var i=n[e];for(var s in i)i.hasOwnProperty(s)&&r.isUndefined(t[s])&&(t[s]=i[s]);n=n.base}return this.factory.chainCache[e]=t,t},set:function(e,t,n){var i={};r.isNumber(e)&&(e=String(e)),r.isString(e)?i[e]=t:(n=t,i=e),n=n||{silent:!1,unset:!1,force:!1};if(n.unset)for(e in i)i.hasOwnProperty(e)&&(i[e]=void 0);var s={},o=0,u=this.$,a,f;for(e in i)if(i.hasOwnProperty(e)){a=i[e];if(n.unset===!0)f=u[e],delete u[e],s[e]=undefined,o++,this.$previousAttributes[e]=f;else if(n.force||!l(u[e],i[e]))f=n.initial?null:u[e],this.$previousAttributes[e]=f,u[e]=i[e],s[e]=u[e],o++}if(o){for(e in s)if(s.hasOwnProperty(e)){var c="_commit"+e.charAt(0).toUpperCase()+e.substr(1);this[c]instanceof Function&&this[c](u[e],this.$previousAttributes[e],n)===!1&&(o--,u[e]=this.$previousAttributes[e])}if(o){this._commitChangedAttributes(s,n);if(!n.silent){for(e in s)s.hasOwnProperty(e)&&this.trigger("change:"+e,s[e],this);this.trigger("change",s,this)}}}return this},setLater:function(e,t){r.isString(e)&&(e={},e[e]=t),r.extend(this.$invalidatedProperties,e),this.$invalidated||(this.$invalidated=!0,a.addCallback(this._commitInvalidatedAttributes))},_commitInvalidatedAttributes:function(){this.set(this.$invalidatedProperties),this.$invalidatedProperties={}},get:function(e,n){n||(n=e,e=this);if(!n)return null;var i;r.isArray(n)?i=n:r.isObject(n)?i=[n]:i=t.parse(n,"path");var s,u;for(var a=0;e&&a<i.length;a++){s=i[a];if(s.type=="fnc"){var f=e[s.name],l=s.parameter;for(var c=0;c<l.length;c++){var h=l[c];r.isObject(h)&&h.type&&h.path&&(l[c]=this.get(h.path))}e=f.apply(e,l)}else s.type=="var"&&(e instanceof o?i.length-1===a?(u=e.$[s.name],r.isUndefined(u)&&(u=e[s.name]),e=u):e=e.get(s.name):e=e[s.name]);e&&s.index!==""&&(r.isArray(e)?e=e[s.index]:e.at&&(e=e.at(s.index)))}return e},has:function(e){return!r.isUndefined(this.get(e))},_commitChangedAttributes:function(e,t){},_hasAll:function(e,t){for(var n=0;n<t.length;n++)if(!e.hasOwnProperty(t[n]))return!1;return!0},_hasSome:function(e,t){for(var n=0;n<t.length;n++)if(e.hasOwnProperty(t[n]))return!0;return!1},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(){return this.set(this.$,{unset:!0})},bind:function(e,i,s,a){if(i instanceof Function&&r.isString(e))this.callBase(e,i,s);else if(r.isString(i)&&i.indexOf("(")>0){a=s;var f=i;i=e;var l,c=t.parse(f,"eventHandler");c.type==="fnc"&&(l=c.parameter);var h=a||this;s=h[f.split("(").shift()],this.callBase(i,new o.EventHandler(s,h,l))}else{r.isArray(e)&&e.length>0&&(a=s,s=i,i=e[1],e=e[0]);var p=new u({path:e,event:i,scope:a,callback:s,value:null});p.set("binding",new n({path:e,scope:this,target:p,targetKey:"value"})),this.$eventBindables.push(p)}},unbind:function(e,t,n,i){if(t instanceof Function&&r.isString(e))this.callBase(e,t,n);else{var s;r.isArray(e)&&e.length>0&&(i=n,n=t,t=e[1],e=e[0]);for(var o=this.$eventBindables.length-1;o>=0;o--)s=this.$eventBindables[o],s.$.scope===i&&s.$.path===e&&s.$.event===t&&s.$.callback===n&&(s.destroy(),this.$eventBindables.slice(o,1))}},_innerDestroy:function(){if(this.$eventBindables){var e=this.$eventBindables.slice();for(var t=0;t<e.length;t++)e[t].destroy();this.$eventBindables=[]}this.callBase()},isDeepEqual:function(e){if(!e)return!1;if(r.size(this.$)!==r.size(e.$))return!1;for(var t in this.$){if(!this.$.hasOwnProperty(t)||!e.$.hasOwnProperty(t))return!1;if(!f(this.$[t],e.$[t]))return!1}return!0},isEqual:function(e){return l(this,e)}}),u=o.inherit({_commitChangedAttributes:function(e){this.callBase();if(e.binding)this.set("value",e.binding.getValue());else if(e.hasOwnProperty("value")){var t=e.value;this._unbindEvent(this.$previousAttributes.value),this._bindEvent(t),this.$.binding&&this.$.binding.triggerBinding()}},_unbindEvent:function(t){t&&t instanceof e&&t.unbind(this.$.event,this.$.callback,this.$.scope)},_bindEvent:function(t){t&&t instanceof e&&t.bind(this.$.event,this.$.callback,this.$.scope)},_innerDestroy:function(){this._unbindEvent(this.$.value),this.$.binding.destroy(),this.callBase()}}),o.EventHandler=e.EventHandler.inherit({ctor:function(e,t,n){this.callBase(),this.parameters=n},trigger:function(e,t){var n;if(this.parameters){var i,s,o;n=[];for(var u=0;u<this.parameters.length;u++){i=this.parameters[u];if(r.isArray(i)){s=i[0];if(s.name==="event")n.push(e);else{s.type==="fnc"?o=t.getScopeForFncName(s.name):s.type==="var"&&(o=t.getScopeForKey(s.name));if(!o)throw new Error("Couldn't find scope for "+s.name);n.push(o.get(i))}}else n.push(i)}}else n=[e];return this.$callback.apply(this.scope,n,t),!e.isPropagationStopped}}),o}),define("js/core/Element",["js/core/Bindable","underscore"],function(e,t){function i(e){if(e&&t.isString(e)){var n=Number(e);if(!isNaN(n))return n;if(e==="true")return!0;if(e==="false")return!1;if(e==="null")return null}return e}var n,r={"type:eventHandler":"eventHandler:","type:function":"function:"},s=e.inherit("js.core.Element",{ctor:function(e,t,r,i,s,o){e=e||{},t||s||(s=this),this.$stage=r,this.$descriptor=t,this.$parentScope=i||null,this.$rootScope=s||null,this.$attributesNamespace=this.$attributesNamespace||{},this.callBase(e,o),this._initializeAttributes(this.$),(t===n||t===null)&&this._initialize(this.$creationPolicy)},_getAttributesFromDescriptor:function(e,t){this.$attributesNamespace=this.$attributesNamespace||{};var n={};if(e&&e.attributes){var s,o;for(var u=0;u<e.attributes.length;u++){s=e.attributes[u];if(s.nodeName.indexOf("xmlns")!==0){o=this._getLocalNameFromNode(s);var a=r[s.namespaceURI],f=!1;if(a==="function:"){var l=t[s.value];if(!l)throw new Error("Cannot find referenced function '"+s.value+"' in scope.");n[o]=l,f=!0}else a&&(o=a+o);f||(n[o]=i(s.value)),s.namespaceURI&&(this.$attributesNamespace[o]=s.namespaceURI)}}}return n},_getLocalNameFromNode:function(e){return e.localName?e.localName:e.nodeName.split(":").pop()},defaults:{creationPolicy:"auto"},_initializeEventAttributes:function(e){},_initializeAttributes:function(e){},_initializeDescriptors:function(){},_initialize:function(e,t){if(this.$initialized||this.$initializing)return;this.$initializing=!0,this._preinitialize(),this.initialize(),this._initializeDescriptors(),this._initializeEventAttributes(this.$),(this===this.$rootScope||this.$parentScope&&this.$parentScope.$initialized||this.$descriptor===!1)&&this._initializeBindings()},_initializeFromCtor:function(){},find:function(e){var t=this.getScopeForKey(e);return this===t?this.get(e):t!=null?t.get(e):null},_preinitialize:function(){},_getTextContentFromDescriptor:function(e){var t=e.textContent||e.nodeValue||e.data||e.text;if(!t){t="";for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(r.nodeType==1||r.nodeType==4)t+=this._getTextContentFromDescriptor(r)}}return t},not:function(e){return!e},isDefined:function(e){return!t.isUndefined(e)}});return s.xmlStringToDom=function(e){if(window&&window.DOMParser)return(new DOMParser).parseFromString(e,"text/xml").documentElement;if(typeof ActiveXObject!="undefined"){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async=!1,t.loadXML(e),t.documentElement}throw"Couldn't parse xml string"},s}),define("js/core/TextElement",["js/core/Element","underscore"],function(e,t){return e.inherit("js.core.TextElement",{defaults:{visible:!0},_initializeDescriptors:function(){if(this.$descriptor){var e=this._getTextContentFromDescriptor(this.$descriptor),t=this.$bindingCreator;if(this.$descriptor&&this.$descriptor.nodeType!=4){var n=t.parse(e);t.containsBindingDefinition(n)?this.$bindingAttributes.textContent={bindingDefinitions:n,value:e}:this.$.textContent=e}else this.$.textContent=e}},render:function(){return this.$initialized||this._initialize(this.$creationPolicy),this.$el=this.$stage.$document.createTextNode(""),this._renderTextContent(this.$.textContent),this.$el},_renderTextContent:function(e){if(t.isUndefined(this.$.textContent)||e===null)e="";this.$el.nodeValue=e,this.$el.data=e},_commitChangedAttributes:function(e){this.$el&&e.hasOwnProperty("textContent")&&this._renderTextContent(e.textContent)}})}),define("js/core/Component",["require","js/core/Element","js/core/TextElement","js/core/Bindable","js/core/EventDispatcher","underscore"],function(e,t,n,r,i,s){var o={},u,a={},f=t.inherit("js.core.Component",{ctor:function(e,t,n,r,i,o){this.$eventDefinitions=[],this.$internalDescriptors=[],this.$xamlDefaults={},this.$xamlAttributes={};var u=this,a;while(u)u._$descriptor&&a!=u&&(this._cleanUpDescriptor(u._$descriptor),this.$internalDescriptors.unshift(u._$descriptor),s.defaults(this.$xamlDefaults,this._getAttributesFromDescriptor(u._$descriptor,i))),u=u.base;e=e||{};var f=this.$xamlDefaults.cid;f&&(e[f]=this,this.$classAttributes=this.$classAttributes||[],this.$classAttributes.push(f)),t&&(this._cleanUpDescriptor(t),this.$xamlAttributes=this._getAttributesFromDescriptor(t,i)),this.$children=[],this.$templates={},this.$configurations=[],this.$children=[],s.defaults(e,this.$xamlAttributes,this.$xamlDefaults),this.callBase(e,t,n,r,i,o)},defaults:{cid:undefined},$errorAttribute:null,$defaultContentName:null,$defaultTemplateName:null,events:[],ENV:function(){return this.$stage.$environment},PARAMETER:function(){return this.$stage.$parameter},bus:function(){return this.$stage.$bus},_preinitialize:function(){this.callBase(),this._setUp()},_initializeBindingsBeforeComplete:function(){for(var e=0;e<this.$children.length;e++)this.$children[e]._initializeBindings();this.callBase()},addChild:function(e,n){if(!(e instanceof t))throw"only children of type js.core.Component can be added";this.$initializing||this.$initialized?(e.$parent=this,e.$rootScope&&e.$.cid&&e.$rootScope.set(e.$.cid,e),n&&n.childIndex!=null?this.$children.splice(n.childIndex,0,e):this.$children.push(e),this.$creationPolicy==="auto"&&e._initialize(this.$creationPolicy),e instanceof f.Template?this._addTemplate(e):e instanceof f.Configuration&&this._addConfiguration(e)):(this.$unitializedChildren=this.$unitializedChildren||[],this.$unitializedChildren.push(e))},removeChild:function(e){if(!(e instanceof t))throw"only children of type js.core.Component can be removed";var n=this.$children.indexOf(e);n!=-1&&(e.$parent=null,this.$children.splice(n,1)),n!=-1&&this.$configurations.splice(n,1),this.$templates.hasOwnProperty(e.$.name)&&delete this.$templates[e.$.name]},removeAllChildren:function(){for(var e=this.$children.length-1;e>-1;e--)this.removeChild(this.$children[e])},_addTemplate:function(e){if(!e.$.name)throw"template without name";this.$templates[e.$.name]=e},_addConfiguration:function(e){this.$configurations.push(e)},getTemplate:function(e){var t=this.$templates[e];return t?t:this.$parent&&this.$parent!=this?this.$parent.getTemplate(e):null},_initializeChildren:function(e){for(var t=0;t<e.length;t++)this.addChild(e[t])},_initializeAttributes:function(e){this.callBase(),this.$creationPolicy!="full"&&e.hasOwnProperty("creationPolicy")&&(this.$creationPolicy=e.creationPolicy,delete e.creationPolicy)},_initializeDescriptors:function(){function o(n){for(var i=0;i<n.length;i++){r=n[i];if(r.$createdByTemplate||s.indexOf(t,r.$descriptor)===-1)e.push(r),r.$descriptor&&t.push(r.$descriptor)}}var e=[],t=[],n,r;if(this.$defaultContentName&&this.$defaultTemplateName)throw"both $defaultContentName and $defaultTemplateName are defined";var i;for(var u=0;u<this.$internalDescriptors.length;u++)i=this.$internalDescriptors[u],o(this._getChildrenFromDescriptor(i,this));var a;if(this.$defaultTemplateName){var l;for(n=0;n<this.$descriptor.childNodes.length;n++){var c=this.$descriptor.childNodes[n];if(c.nodeType===1&&c.getAttribute("name")===this.$defaultTemplateName&&this.$stage.$applicationContext.getFqClassName(c.namespaceURI,this._localNameFromDomNode(c),!0)==="js/core/Template"){l=c;break}}!l&&this.$descriptor&&(l=this.createComponent(f.Template,{name:this.$defaultTemplateName},this.$descriptor),a=[l])}a=a||this._getChildrenFromDescriptor(this.$descriptor);if(this.$defaultContentName&&this.$descriptor){var h,p=e.concat(a);for(n=0;n<p.length;n++){r=p[n];if(r instanceof f.Content&&r.$.name===this.$defaultContentName){h=r;break}}if(!h){h=this.createComponent(f.Content,{name:this.$defaultContentName});for(n=0;n<a.length;n++)h.addChild(a[n]);a=[h]}}o(a);var d=this.createChildren();d&&o(d),this._initializeChildren(e),this._childrenInitialized(),this._initializeXamlEventAttributes(this.$xamlDefaults,this),this._initializeXamlEventAttributes(this.$xamlAttributes,this.$rootScope)},createChildren:function(){if(this.$unitializedChildren){var e=[];while(this.$unitializedChildren.length)e.push(this.$unitializedChildren.shift());return e}},_cleanUpDescriptor:function(e){if(e&&e.childNodes){var t,n;for(var r=e.childNodes.length-1;r>=0;r--)t=e.childNodes[r],t.nodeType===3&&(n=t.textContent||t.text||t.data,(!n||n.trim().length===0)&&e.removeChild(t))}else this.log("Descriptor not defined or not correct","warn")},_isEventAttribute:function(e){return e.indexOf("eventHandler:")===0},_isFunctionAttribute:function(e){return e.indexOf("function:")===0},_isXamlEventAttribute:function(e){return e.indexOf("on")===0},_getEventName:function(e){return e.substr(3)},_isComponentEvent:function(e){for(var t=0;t<this.events.length;t++)if(e==this.events[t])return!0;return!1},_getEventTypeForAttribute:function(e){return this._eventAttributes[e]},_initializeXamlEventAttributes:function(e,t){var n="",r,i,s;for(var o in e)if(e.hasOwnProperty(o)){i=e[o];if(this._isXamlEventAttribute(o)){var u=i.indexOf("(");u>0?s=i.substr(0,u):s=i;if(!t[s])throw"Couldn't find callback "+i+" for "+o+" event";n=o.substr(2),r=t[i],this.bind("on:"+n,u>0?i:t[i],t)}else this._isEventAttribute(o)&&this.bind(o.split(":")[1],t[i],t)}},_createComponentForNode:function(e,t,n){if(!e)return null;t=t||{},n=n||this.$rootScope;var r=null;if(e.nodeType==1){var i=e.namespaceURI,s=this._localNameFromDomNode(e),u=i+":"+s,a=o[u];if(a)r=new a(t,e,this.$stage,this,n,!0);else{var f=this.$stage.$applicationContext.getFqClassName(i,s,!0),l=this.$stage.$applicationContext.getFqClassName(i,s,!1);r=this.$stage.$applicationContext.createInstance(f,[t,e,this.$stage,this,n,!0],l),o[u]=r.factory}}else if(e.nodeType==3||e.nodeType==4)r=this._createTextElement(e,n,t);return r},createComponent:function(e,t,n){return n=n||!1,t=t||[],e instanceof Function?new e(t,n,this.$stage,this,this.$rootScope,!0):this.$stage.$applicationContext.createInstance(e,[t,n,this.$stage,this,this.$rootScope,!0])},createBinding:function(e,t,n){n=n||this,this.$bindingCreator.evaluate(e,this,function(){t.apply(n,arguments)})},_createTextElement:function(e,t,n){if(u)return new u(n,e,this.$stage,this,t,!0);var r=this.$stage.$applicationContext.createInstance("js/core/TextElement",[n,e,this.$stage,this,t,!0]);return u=r.factory,r},_getChildrenFromDescriptor:function(e,t,n){var r=[],i,o;if(e&&e.childNodes)for(var u=0;u<e.childNodes.length;u++)i=e.childNodes[u],o=this._createComponentForNode(i,s.clone(n),t),o&&r.push(o);return r},_childrenInitialized:function(){},initialize:function(e){},_localNameFromDomNode:function(e){if(e.localName)return e.localName;var t=a[e.tagName];if(t)return t;var n=e.tagName.split(":");return a[e.tagName]=n[n.length-1],a[e.tagName]},baseUrl:function(e){return e=e||"",this.$stage&&(e=(this.$stage.$applicationContext.$config.baseUrl||"")+e),e}});return f.Template=f.inherit("js.core.Template",{defaults:{name:null},_initializeDescriptors:function(){this._cleanUpDescriptor(this.$descriptor),this._childrenInitialized()},createComponents:function(e,t){t=t||this.$parentScope;var n=this._getChildrenFromDescriptor(this.$descriptor,null,e);for(var r=0;r<n.length;r++)n[r].$createdByTemplate=!0,n[r].$parentScope=t;return n},createInstance:function(e,t){var n=this.createComponents(e,t);return n[0]}}),f.Configuration=f.inherit("js.conf.Configuration",{getConfigurationByKeyValue:function(e,t,n){arguments.length<3&&(n=!0);var r,i,s;for(i=0;i<this.$configurations.length;i++){r=this.$configurations[i];if(r.$[e]===t)return r}if(n)for(i=0;i<this.$configurations.length;i++){r=this.$configurations[i],s=r.getConfigurationByKeyValue(e,t);if(s)return s}return null}}),f.Content=f.inherit("js.core.Content",{defaults:{name:null},getChildren:function(){var t,r=[];for(var i=0;i<this.$children.length;i++)t=this.$children[i],(t instanceof e("js/core/DomElement")||t instanceof n)&&r.push(t);return r}}),f}),define("js/core/Content",["js/core/Component"],function(e){return e.Content}),define("js/core/DomElement",["require","js/core/EventDispatcher","js/core/Component","js/core/Content","inherit","underscore","js/core/Base"],function(e,t,n,r,i,s,o){var u=/\s+/,a,f,l={pointer:"click",pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend"},c={pointer:"click",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerout:"mouseout",pointerover:"mouseover",pointerhover:"mouseover"},h={pointer:"click",pointerdown:"MSPointerDown",pointermove:"MSPointerMove",pointerup:"MSPointerUp",pointerout:"MSPointerOut",pointerover:"MSPointerOver",pointerhover:"MSPointerHover"},p={$classAttributes:[/^\$/,/^xmlns/,/^on/,"cid",/^_/],defaults:{"class":null,componentClass:null,animationClass:null,visible:!0,enabled:!0},ctor:function(e,t,n,r,i){this.$addedToDom=!1,this.$renderMap={},this.$children=[],this.$invisibleChildMap={},this.$animationDurationCache={},this.$renderedChildren=[],this.$contentChildren=[],this.$domEventHandler={};var s=this;while(s)s.$classAttributes&&(this.$classAttributes=this.$classAttributes.concat(s.$classAttributes)),s=s.base;this.callBase(),t&&(this.$tagName||(this.$tagName=this._getLocalNameFromNode(t)),this.$namespace||(this.$namespace=t.namespaceURI)),this.bind("add:dom",this._onDomAdded,this)},_onDomAdded:function(){this.$addedToDom=!0;for(var e=0;e<this.$renderedChildren.length;e++)this.$renderedChildren[e].trigger("add:dom",this.$el)},_inject:function(){this.callBase();var e=this._injectChain();for(var t in e)e.hasOwnProperty(t)&&this.$classAttributes.push(t)},_initializeAttributes:function(e){this.callBase(),e.tagName&&(this.$tagName=e.tagName,delete e.tagName),e.namespace&&(this.$namespace=e.namespace,delete e.namespace)},addChild:function(e,t){this.callBase();if(e.$initialized||e.$initializing)if(e instanceof m||e.render){var n=t&&t.childIndex!=null?t.childIndex:this.$children.length;this.isRendered()&&this._renderChild(e,n)}else e instanceof r&&this.$contentChildren.push(e)},removeChild:function(e){this.callBase(),(e instanceof m||e.render)&&this.isRendered()&&this._removeRenderedChild(e)},getPlaceHolder:function(e){var t;for(var n=0;n<this.$children.length;n++){t=this.$children[n];if(t.render instanceof Function&&t.$.name===e)return t}var r;for(n=0;n<this.$children.length;n++){t=this.$children[n];if(t.getPlaceHolder){r=t.getPlaceHolder(e);if(r)return r}}return null},remove:function(){this.$parent&&this.$parent.removeChild(this)},getViewChildren:function(){var e=[];for(var t=0;t<this.$children.length;t++)this.$children[t].render instanceof Function&&e.push(this.$children[t]);return e},getContentPlaceHolders:function(){f||(f=e("js/ui/ContentPlaceHolder"));var t=[],n;for(var r=0;r<this.$children.length;r++)n=this.$children[r],f&&n instanceof f?t.push(n):n instanceof m&&(t=t.concat(n.getContentPlaceHolders()));return t},findContent:function(e){var t,n;for(var i=0;i<this.$contentChildren.length;i++){t=this.$contentChildren[i];if(t instanceof r&&t.$.name===e)return t}for(i=0;i<this.$contentChildren.length;i++){t=this.$contentChildren[i];if(t.findContent){n=t.findContent(e);if(n)return n}}return null},render:function(){this.$initialized||this._initialize(this.$creationPolicy);if(this.isRendered())return this.$el;this.$renderedChildren=[],this.$el=this._createDomElement(this.$tagName,this.$namespace),this._initializeRenderer(this.$el),this._renderChildren(this.$children),this._renderContentChildren(this.$contentChildren),this._renderAttributes(this.$),this._bindDomEvents(this.$el);if(this.$stage.$applicationContext.$config.enableInspection===!0){var e=this;this.$el.inspect=function(){return e}}return this.$el},_createDomElement:function(e,t){return this.$stage.$document.createElementNS&&t&&/^http/.test(t)?this.$stage.$document.createElementNS(t,e):this.$stage.$document.createElement(e)},_bindDomEvents:function(e){var t,n;for(var r=0;r<this.$eventDefinitions.length;r++)t=this.$eventDefinitions[r],this.bind(t.type,t.eventHandler,t.scope)},_initializeRenderer:function(e){},_renderChildren:function(e){var t;for(var n=0;n<e.length;n++)t=e[n],this._renderChild(t)},_renderEnabled:function(e){"disabled"in this.$el&&(e?this.$el.removeAttribute("disabled"):this.$el.setAttribute("disabled",!0)),e?this.removeClass("disabled"):this.addClass("disabled")},_renderContentChildren:function(e){var t;for(var n=0;n<e.length;n++){t=e[n];var r=t.get("name"),i=this.getPlaceHolder(r);i&&i.set({content:t})}},_renderChild:function(e,t){if(s.isFunction(e.render)){e.$renderParent=this;if(e.$.visible){delete this.$invisibleChildMap[e.$cid];var n=e.render();if(t==a)this.$el.appendChild(n),this.$renderedChildren.push(e);else{var r=0;for(var i=0;i<t&&i<this.$children.length;i++){var o=this.$children[i];(!o.render||!o.$.visible)&&r++}t-=r,this.$renderedChildren.splice(t,0,e);var u=this.$el.childNodes[t];u?this.$el.insertBefore(n,u):this.$el.appendChild(n)}if(e.$.animationClass){var f=e.$.animationClass+"-add";e.addClass(f);var l=this.$animationDurationCache[f]||this._calculationAnimationDuration(e);this.$animationDurationCache[f]=l,setTimeout(function(){e.removeClass(f)},l)}this.$addedToDom&&e.trigger("add:dom",this.$el)}else this.$invisibleChildMap[e.$cid]=e}},_calculationAnimationDuration:function(e){function r(e){var t=[n,"Animation",e].join("");return n==="o"&&(t=t.toLowerCase()),t}function i(e){var t=[n,"Transition",e].join("");return n==="o"&&(t=t.toLowerCase()),t}var t=window.getComputedStyle(e.$el,null),n=this.$stage.$browser.vendorPrefix,s=Math.max(parseFloat(t[r("Delay")]),parseFloat(t[i("Delay")]))||0,o=Math.max(parseFloat(t[r("Duration")]),parseFloat(t[i("Duration")]))||0,u=Math.max(parseInt(t[r("Count")]),parseInt(t[i("Count")]))||1;return(s+o)*u*1e3},_renderSelected:function(e){e?this.addClass("active"):this.removeClass("active")},_commitVisible:function(e){if(this.$renderParent&&!this.isRendered()&&e){var t=this.$renderParent.$children,n=t.indexOf(this);this.$renderParent._renderChild(this,n)}},_renderVisible:function(e){this.$renderParent&&(e?this.$renderParent.setChildVisible(this):this.$renderParent.setChildInvisible(this))},_renderComponentClass:function(e,t){t&&this.removeClass(t),e&&this.addClass(e)},_renderClass:function(e,t){t&&this.removeClass(t),e&&this.addClass(e)},_removeRenderedChild:function(e){if(this.isRendered()){var t;for(var n=this.$renderedChildren.length-1;n>=0;n--){t=this.$renderedChildren[n];if(e===t){this._internalRemoveChild(e),this.$renderedChildren.splice(n,1);return}}}},_internalRemoveChild:function(e){if(!e.$.visible)return;var t=this.$el;if(e.$.animationClass){var n=e.$.animationClass+"-remove";e.addClass(n);var r=this.$animationDurationCache[n]||this._calculationAnimationDuration(e);this.$animationDurationCache[n]=r,setTimeout(function(){t.removeChild(e.$el)},r)}else this.$el.removeChild(e.$el)},_clearRenderedChildren:function(){if(this.isRendered()){var e;for(var t=this.$renderedChildren.length-1;t>=0;t--)e=this.$renderedChildren[t],this._internalRemoveChild(e)}this.$renderedChildren=[]},_getIndexOfPlaceHolder:function(e){if(this.$layoutTpl){var t,n;for(var r=0;r<this.$layoutTpl.$children.length;r++){t=this.$layoutTpl.$children[r];if(n==t.$cid)return r}}return-1},isRendered:function(){return typeof this.$el!="undefined"},_renderAttributes:function(e){var t;for(var n in e)e.hasOwnProperty(n)&&(t=e[n],this._renderAttribute(n,t))},_renderAttribute:function(e,t){var n=this.$renderMap[e],r=this.$previousAttributes[e];if(s.isUndefined(n)){var i=e.charAt(0).toUpperCase()+e.substr(1),o="_render"+i;n=this[o],s.isFunction(n)||(n=!1),this.$renderMap[e]=n}n!==!1?n.call(this,t,r):this._renderAttributeInternal(e,t)},_renderAttributeInternal:function(e,t){this._isDOMNodeAttribute(e)&&this._setAttribute(e,t)},_isDOMNodeAttribute:function(e){var t;for(var n=0;n<this.$classAttributes.length;n++){t=this.$classAttributes[n];if(t instanceof RegExp){if(t.test(e))return!1}else if(t==e)return!1}return!0},_setAttribute:function(e,t,n){!s.isUndefined(t)&&t!==null?(n=n||this.$attributesNamespace[e],this.$el.setAttributeNS&&n?this.$el.setAttributeNS(n,e,t):this.$el.setAttribute(e,t)):(this.$el.setAttribute(e,""),this.$el.removeAttribute(e))},_commitChangedAttributes:function(e){this.isRendered()&&this._renderAttributes(e)},_innerDestroy:function(){if(this.$children)for(var e=0;e<this.$children.length;e++)this.$children[e].destroy();this.callBase()},html:function(){return this.isRendered()||this.render(),this.$el.innerHTML}.on("change"),dom:function(e){return new v(e||this,this.$stage)},setChildIndex:function(e,t){t<0&&(t+=this.$children.length),t>=this.$children.length&&(t-=this.$children.length);var n=this.$children.indexOf(e);if(n!==t){this.$children.splice(n,1),this.$children.splice(t,0,e);if(this.isRendered()&&e.isRendered()&&this.$renderedChildren.length>1){this.$el.removeChild(e.$el);var r=this._getNextVisibleChild(e);r?this.$el.insertBefore(e.$el,r.$el):this.$el.appendChild(e.$el)}}},bringToFront:function(){this.$parent&&this.$parent.setChildIndex(this,this.$parent.$children.length-1)},sendToBack:function(){this.$parent&&this.$parent.setChildIndex(this,0)},setChildInvisible:function(e){if(this.isRendered()){var t=this.$renderedChildren.indexOf(e);t>-1&&(this.$renderedChildren.splice(t,1),e.$el.parentNode&&this.$el.removeChild(e.$el),this.$invisibleChildMap[e.$cid]=e)}},setChildVisible:function(e){if(this.isRendered()&&this.$invisibleChildMap[e.$cid]){e.isRendered()||e.render();var t=this._getNextVisibleChild(e);if(t){var n=this.$renderedChildren.indexOf(t);this.$renderedChildren.splice(n,0,e),this.$el.insertBefore(e.$el,t.$el)}else this.$renderedChildren.push(e),this.$el.appendChild(e.$el);this.$addedToDom&&e.trigger("add:dom",this.$el),delete this.$invisibleChildMap[e.$cid]}},_getNextVisibleChild:function(e){if(this.$el.childNodes.length===0)return null;var t=this.$children.indexOf(e),n;for(var r=t+1;r<this.$children.length;r++){n=this.$children[r];if(n.render instanceof Function&&!this.$invisibleChildMap[n.$cid]&&n.$.visible)break}return r<this.$children.length&&e!==this.$children[r]?this.$children[r]:null},_createDOMEventHandler:function(e){return e.indexOf("on:pointer")===0?new m.PointerEventHandler(this,e):new m.EventHandler(this,e)},bind:function(e,t,n){if(e.indexOf("on:")===0&&!this.$domEventHandler[e]&&!this._isComponentEvent(e))if(this.isRendered()){var r=this.$domEventHandler[e]=this._createDOMEventHandler(e);this.bindDomEvent(e.substr(3),r),this.callBase()}else this.$eventDefinitions.push({scope:n||this,type:e,eventHandler:t});else this.callBase()},unbind:function(e,t,n){this.callBase();var r=this._eventHandlers[e];if(r&&r.length===0){var i=this.$domEventHandler[e];i&&this.unbindDomEvent(this._mapDOMEventType(e),i)}}},d={hasClass:function(e){return(new RegExp("\\b"+e+"\\b")).test(this.$el.getAttribute("class")||"")},addClass:function(e){var t=(""+e).split(u),n=this.$el.getAttribute("class")||"";if(!n&&t.length===1)n=e;else{var r=n.split(u);for(var i=0;i<t.length;i++)r.indexOf(t[i])==-1&&r.push(t[i]);n=r.join(" ")}this.$el.setAttribute("class",n)},removeClass:function(e){var t=this.$el.getAttribute("class")||"";if(!t||!t.length)return;var n=e.split(u),r=t.split(u);for(var i=0;i<n.length;i++){var s=r.indexOf(n[i]);s!=-1&&r.splice(s,1)}r.length===0?this.$el.removeAttribute("class"):this.$el.setAttribute("class",r.join(" "))},bindDomEvent:function(e,t){e=this._mapDOMEventType(e);if(this.$el.addEventListener)this.$el.addEventListener(e,t,!1);else if(this.$el.attachEvent){var n=t;t instanceof m.EventHandler&&(n=t._handleEvent=function(e){return t.handleEvent(e)}),this.$el.attachEvent("on"+e,n)}},unbindDomEvent:function(e,t){e=this._mapDOMEventType(e);if(this.$el.removeEventListener)this.$el.removeEventListener(e,t,!1);else if(this.$el.detachEvent){var n=t;t instanceof m.EventHandler&&(n=t._handleEvent),this.$el.detachEvent("on"+e,n)}},_mapDOMEventType:function(e){return e.indexOf("pointer")===0?this.$stage.$browser.msPointerEnabled?h[e]||e:this.$stage.$browser.hasTouch?l[e]||e:c[e]||e:e},focus:function(){this.isRendered()&&this.$el.focus()},localToGlobal:function(e){e=e||{x:0,y:0};var t=this._getHtmlTag();if(!t)throw new Error("Html tag not found");var n=t.getBoundingClientRect(),r=this.$el.getBoundingClientRect();return{x:-n.top+r.top+t.offsetTop+e.x,y:-n.left+r.left+t.offsetLeft+e.y}},globalToLocal:function(e){e=e||{x:0,y:0};var t=this._getHtmlTag();if(!t)throw new Error("Html tag not found");var n=t.getBoundingClientRect(),r=this.$el.getBoundingClientRect();return{x:e.x+n.left-t.offsetLeft-r.left,y:e.y+n.top-t.offsetTop-r.top}},_getHtmlTag:function(){var e=this.$stage.$document;return this.$stage.$html||(this.$stage.$html=e.getElementsByTagName("html")[0]),this.$stage.$html}},v=i.Base.inherit(s.extend({ctor:function(e,t){this.$stage=t,this.$el=e}},d)),m=n.inherit("js.core.DomElement",s.extend(p,d));return m.Event=t.Event.inherit("js.core.DomElement.Event",{ctor:function(e){this.domEvent=e,this.callBase(e),this.isDefaultPrevented=!!e.defaultPrevented},stopPropagation:function(){this.callBase();var e=this.domEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},preventDefault:function(){this.callBase();var e=this.domEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}}),m.PointerEvent=m.Event.inherit("js.core.DomElement.PointerEvent",{ctor:function(e){e.changedTouches||e.touches?(this.isTouch=!0,this.pointerEvent=e.touches.length?e.touches[0]:e.changedTouches[0]):this.pointerEvent=e,this.callBase(e)}}),m.EventHandler=o.inherit("js.core.DomEvent.EventHandler",{ctor:function(e,t){this.component=e,this.type=t},handleEvent:function(e){return this._isEventEnabled()?(e=this._createEvent(e),this.component.trigger(this.type,e,this.component),!e.isPropagationStopped):(e.preventDefault(),!1)},_isEventEnabled:function(){return!this.component.$.enabled&&s.include(["on:click","on:dblclick","on:pointer"],this.type)?!1:!0},_createEvent:function(e){return new m.Event(e)}}),m.PointerEventHandler=m.EventHandler.inherit("js.core.DomEvent.PointerEventHandler",{_createEvent:function(e){return new m.PointerEvent(e)}}),m}),define("js/html/HtmlElement",["js/core/DomElement","underscore"],function(e,t){var n="http://www.w3.org/1999/xhtml",r="out",i="in",s="both",o={height:"offsetHeight",width:"offsetWidth"},u=function(e,t,n){(t===i||t===s)&&e.set(n,e.$el[o[n]])},a=function(e,t,n){if(t===i||t===s){if(!e["__update"+n]){var r=e;e["__update"+n]=function(){setTimeout(function(){r.set(n,r.$el[o[n]])},1)},e.dom(e.$stage.$window).bindDomEvent("resize",e["__update"+n])}}else e["__update"+n]&&(e.dom(e.$stage.$window).unbindDomEvent("resize",e["__update"+n]),delete e["__update"+n])},f=e.inherit("js.html.HtmlElement",{defaults:{selected:null,selectable:null,namespace:n,position:null,heightUpdatePolicy:"out",widthUpdatePolicy:"out"},$classAttributes:["heightUpdatePolicy","widthUpdatePolicy","content"],$excludedStyleAttributes:["src","content","item"],$renderAsStyleWithPx:["left","top","maxWidth","maxHeight"],_onDomAdded:function(){this.callBase(),this.checkSizePolicies()},checkSizePolicies:function(){u(this,this.$.widthUpdatePolicy,"width"),u(this,this.$.heightUpdatePolicy,"height")},_renderHeightUpdatePolicy:function(e){a(this,e,"height")},_renderWidthUpdatePolicy:function(e){a(this,e,"width")},_setAttribute:function(e,n){t.indexOf(this.$renderAsStyleWithPx,e)!==-1&&n!=null&&!t.isString(n)&&(n+="px"),this.callBase(e,n)},_renderSelectable:function(e){if(e){if(!this._onSelect){var t=this;this._onSelect=function(){t.$.enabled&&t.set({selected:!t.$.selected})}}this.bindDomEvent("click",this._onSelect)}else this._onSelect&&this.unbindDomEvent("click",this._onSelect)},_renderWidth:function(e){e!==undefined&&e!==null&&typeof e!="string"&&(e+="px"),this._renderPolicyValue("width",e)},_renderHeight:function(e){e!==undefined&&e!==null&&typeof e!="string"&&(e=Math.min(17895697,e),e+="px"),this._renderPolicyValue("height",e)},_renderPolicyValue:function(e,t){var n=this.$[e+"UpdatePolicy"];(n===r||n===s)&&t!=null&&t!==undefined&&(this.$el.style[e]=t)},_renderAttributeInternal:function(e,n){if(this._isStyleAttribute(e)){t.indexOf(this.$renderAsStyleWithPx,e)!==-1&&n!=null&&!t.isString(n)&&(n+="px");var r,i,s,o;if(/-/.test(e)){r=e,s=f.dashFormatTransformCache[e];if(!s){var u=e.split("-");s=u[0];for(o=1;o<u.length;o++)s+=u[o].charAt(0).toUpperCase()+u[o].substr(1);f.dashFormatTransformCache[e]=s}i=s}else{i=e,s=f.camelCaseFormatTransformCache[e];if(!s){var a=e.split(/(?=[A-Z])/);s=a[0];for(o=1;o<a.length;o++)s+="-"+a[o].charAt(0).toLowerCase()+a[o].substr(1);f.camelCaseFormatTransformCache[e]=s}r=s}i in this.$el.style&&(n!=null?this.$stage.$browser.isIE?this.$el.style[r]=n:this.$el.style.setProperty(r,n,null):this.$el.style.setProperty?this.$el.style.removeProperty(r):this.$el.style.removeAttribute(r))}else e==="src"&&(this.$stage.$browser.isFF||this.$stage.$browser.isIE)&&this.$el.removeAttribute(e),this.callBase()},_isStyleAttribute:function(e){var n=this.$stage.$supportedCssProperties;if(!n&&this.runsInBrowser()){var r=this.$stage.$window,i=this.$stage.$document;n=this.$stage.$supportedCssProperties=[];if(i&&r){var s=i.body||i.getElementsByName("body")[0]||i.getElementsByName("html")[0];if(s){var o=r.getComputedStyle(s,null);for(var u=0;u<o.length;u++)n.push(o[u])}}}return t.indexOf(this.$excludedStyleAttributes,e)===-1&&this.$el&&(e in this.$el.style||n&&t.indexOf(n,e)!==-1)}});return f.camelCaseFormatTransformCache={},f.dashFormatTransformCache={},f.HTML_Namespace=n,f}),define("js/ui/View",["js/html/HtmlElement","js/core/Content","underscore"],function(e,t,n){return e.inherit({defaults:{tagName:"div"},$domAttributes:["class","id","style","tabindex"],render:function(){if(this.isRendered())return this.$el;var e=this.$templates.layout;if(e){var t=e.createComponents({},this);this._initializeLayoutChildren(t)}return this.callBase()},_isDOMNodeAttribute:function(e){return this.callBase()&&(/^data-/.test(e)||n.indexOf(this.$domAttributes,e)!==-1)},_initializeLayoutChildren:function(e){for(var t=0;t<e.length;t++)e[t].$rootScope=this,this.addChild(e[t])},_renderChild:function(e){this.callBase();if(e instanceof t){var n=e.get("name");if(n){var r=this.getPlaceHolder(n);r&&r.set({content:e})}}},_renderLayoutClass:function(e,t){n.each(this.$renderedChildren,function(n){t&&n.removeClass(t),e&&n.addClass(e)})},_renderTemplateToPlaceHolder:function(e,t,n){this.$renderedPlaceholders=this.$renderedPlaceholders||{};var r=this.$renderedPlaceholders[t],i,s=this.getTemplate(e);s&&(r=s.createInstance(n),i=this.getPlaceHolder(t),i&&(i.set({content:r}),this.$renderedPlaceholders[t]=r))},_renderId:function(e){e?this.$el.setAttribute("id",e):this.$el.removeAttribute("id")}})}),define("js/core/Window",["js/ui/View"],function(e){return e.inherit("js.core.Window",{defaults:{tagName:"div",componentClass:"window",closeOnBackdrop:!1},events:["on:backdropClick"],ctor:function(){this.callBase(),this.bind("on:backdropClick",this._onbackdropClick,this)},_onbackdropClick:function(e){this.$.closeOnBackdrop&&this.close()},show:function(e,t){this.$stage.$windowManager.show(this,e,t)},showModal:function(e){this.show(e,!0)},close:function(e){this.trigger("close",e)},_renderWindowClass:function(e,t){t&&this.removeClass(t),e&&this.addClass(e)}})}),define("js/core/WindowManager",["js/html/HtmlElement","underscore","require","js/core/Window"],function(e,t,n,r){return e.inherit("js.core.WindowManager",{ctor:function(){this.$windows=[],this.$modalWindows=[],this.callBase()},defaults:{tagName:"div","class":"window-manager {modalActiveClass()} {activeModalsClasses()}"},modalActiveClass:function(){return this.$modalWindows.length>0?"modal-active":""}.on("modalStateChanged"),activeModalsClasses:function(){var e=[];for(var t=0;t<this.$modalWindows.length;t++){var n=this.$modalWindows[t];n&&n.$.name&&e.push(n.$.name+"-active")}return e.join(" ")}.on("modalStateChanged"),show:function(n,r,i){var s=this,o=i?this.$modalWindows:this.$windows,u=n;if(i){u=this.createComponent(e,{tagName:"div",componentClass:"modal"});var a=this.createComponent(e,{tagName:"div","class":"modal-backdrop back-drop"});u.addChild(a),a.bind("on:pointer",function(){n.trigger("on:backdropClick")}),u.addChild(n),n.set("windowClass","modal window")}this.addChild(u),o.push(n),i&&this.trigger("modalStateChanged");var f=function(e){s.removeChild(u),o.splice(t.indexOf(o,n),1),n.unbind("close",f),s.trigger("modalStateChanged"),r&&r(null,n,e.$)};n.bind("close",f,this)},createWindow:function(e,t){var i=this;e=this.$stage.$applicationContext.getFqClassName(e),n([e],function(n){n.classof(r)?t&&t(null,i.createComponent(n)):t&&t(new Error("Window of class '"+e+"' is not a window"))},function(e){t&&t(e)})}})}),define("js/core/ExternalInterface",["js/core/Base"],function(e){return e.inherit("js.core.ExternalInterface",{ctor:function(e){if(!e)throw new Error("ExternalInterface needs to be injected");this.$interface={};if(e&&e.$externalInterface)return e.$externalInterface;this.$stage=e},addCallback:function(e,t,n){var r=function(){var e=Array.prototype.slice.call(arguments);return t.apply(n,e)};this.$interface[e]=r,this.runsInBrowser()&&this.$stage&&this.$stage.$el&&(this.$stage.$el[e]=r)},_stageRendered:function(e){for(var t in this.$interface)this.$interface.hasOwnProperty(t)&&(e[t]=this.$interface[t])}})}),define("js/core/ErrorProvider",["js/core/Component"],function(e){return e.inherit("js.core.ErrorProvider",{defaults:{i18n:null,scope:"error"},getErrorMessage:function(e){return e?this.$.i18n?this.$.i18n.ts(this.$.scope,e.$.code,e.$.field)||e.$.message||e:e.$.message||e:null}})}),define("js/core/Stage",["js/html/HtmlElement","js/core/Bus","js/core/WindowManager","js/core/ExternalInterface","js/core/ErrorProvider"],function(e,t,n,r,i){var s={hasTouch:["touch","no-touch"],supportsTransition:["transition","no-transition"],isMobile:["mobile","desktop"],supportViewPortRelativeSize:["vs-support","no-vs-support"]};return e.inherit("js.core.Stage",{$containerOrder:{windows:0,popups:1,tooltips:2},defaults:{tagName:"div",componentClass:"stage"},ctor:function(e,n,i,s){this.$requirejsContext=e,this.$applicationContext=n,this.$applicationFactory=null,this.$document=i,this.$window=s,this.$bus=new t(this),this.$externalInterface=new r(this),this.$containers={},this.$elements={},this.callBase(null,!1,this,null,this),this.$browser=this._createBrowserObject(),this._annotateBrowserInformation(this.$browser)},_addInjectionFactories:function(e){e.addFactory({type:"js.core.ErrorProvider",factory:i,singleton:!0})},_createBrowserObject:function(){var e={};e.isBrowser=this.runsInBrowser();if(this.runsInBrowser()){var t=this.$window,n=t.document,r=n.body||n.getElementsByTagName("body")[0];e.hasTouch="ontouchend"in t,e.has3D="WebKitCSSMatrix"in t&&"m11"in new WebKitCSSMatrix,e.msPointerEnabled="msPointerEnabled"in t.navigator;var i=n.createElement("div");i.setAttribute("style","position: absolute; height: 100vh; width: 100vw"),r.appendChild(i),e.supportViewPortRelativeSize=t.innerWidth===i.offsetWidth,r.removeChild(i);var s=t.navigator;if(s){var o=s.userAgent||s.appVersion,u=/(iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm)/i.exec(o);e.isMobile=!!u,e.isIOS=!!o.match(/(iPad|iPhone|iPod)/g),u&&(e.mobileType=u[1].toLowerCase());var a=/win|mac|linux|x11/i.exec(o);a&&(a={win:"windows",mac:"mac",linux:"linux",x11:"unix"}[a[0].toLowerCase()],e.os=a);var f=/(firefox)|(chrome)|(safari)/i.exec(o);f&&(e.isFF=!!f[1],e.isChrome=!!f[2],e.isSafari=!!f[3],f=f[0].toLowerCase(),e.name=f),f=/msie\s(\d+)/i.exec(o),f?(f="ie ie"+f[1],e.name=f,e.isIE=!0):e.isIE=!1,e.name=e.name||"";var l=/(?:opera|chrome|safari|firefox|msie|trident)\/?\s*([\d]+)/i.exec(o);l&&l[1]&&(e.version=l[1])}var c=t.document.createElement("div").style;e.supportsTransition="transition"in c||"WebkitTransition"in c||"MozTransition"in c||"msTransition"in c||"OTransition"in c;function h(){return"WebkitTransition"in c?"webkit":"MozTransition"in c?"Moz":"msTransition"in c?"MS":"OTransition"in c?"o":""}e.vendorPrefix=h()}return e},_annotateBrowserInformation:function(e){var t=["stage"],n;for(var r in e)e.hasOwnProperty(r)&&(n=e[r],typeof n=="boolean"?s.hasOwnProperty(r)?t.push(s[r][n?0:1]):r==="isIOS"&&n&&(t.push("ios"),t.push("ios"+this._getIOSVersion())):r==="version"?t.push(e.name+n):t.push(n));this.set("componentClass",t.join(" "))},_getIOSVersion:function(){var e=this.$window.navigator.userAgent.match(/OS ([0-9]+)(?:_[0-9])* like Mac OS/);return e&&e.length>0?e[1]:""},createChildren:function(){return this.$windowManager=this.createComponent(n),[this.$windowManager]},render:function(e){var t=this.callBase(null);return this.$externalInterface&&this.$externalInterface._stageRendered(t),e&&(e.appendChild(t),this.rendered=!0,this.$bus.trigger("Stage.Rendered",e),this.trigger("add:dom",e)),t},createWindow:function(e){return this.createHtmlElement(e,"windows")},createTooltip:function(e){return this.createHtmlElement(e,"tooltips")},createHtmlElement:function(e,t){var n=this.$containers[t];n||(n=this.createContainer({"class":t+"-container"}),this.$containers[t]=n,this.addChild(n),this.$containerOrder[t]&&n.setChildIndex(this.$containerOrder[t]));var r=this.$elements[t+"_"+e];return r||(r=this.createContainer({}),n.addChild(r)),r.$el},createContainer:function(t){return t=t||{},this.$stage.$applicationContext.createInstance(e,[t,null,this.$stage,this,this])},destroy:function(){this.callBase(),this.$requirejsContext=null,this.$applicationContext=null,this.$applicationFactory=null,this.$document=null,this.$window=null,this.$bus=null,this.$externalInterface=null,this.$containers=null,this.$elements=null,this.$browser=null,this.$application.destroy()}})}),define("js/core/InterCommunicationBus",["js/core/Base","underscore"],function(e,t){return e.inherit("js.core.InterCommunicationBus",{ctor:function(){this.$busses=[]},trigger:function(e,t){for(var n=0;n<this.$busses.length;n++)try{this.$busses[n].trigger(e,t)}catch(r){this.log(r,"error")}},registerBus:function(e){this.$busses.push(e)},unregisterBus:function(e){var n=t.indexOf(this.$busses,e);n!==-1&&this.$busses.splice(n,1)}})}),define("js/core/HeadManager",["js/core/Bindable"],function(e){return e.inherit("js.core.HeadManager",{ctor:function(e){this.$head=e.head||e.getElementsByTagName("head")[0],this.$document=e,this.$metaTags=[],this.callBase(null),this.bind("change",this._render,this)},_render:function(){if(!this.$title){var e=this.$head.getElementsByTagName("title");e.length?this.$title=e[0]:(this.$title=this.$document.createElement("title"),this.$head.appendChild(this.$title))}for(var t=0;t<this.$metaTags.length;t++)this.$head.removeChild(this.$metaTags[t]);this.$metaTags=[];var n=this.$,r,i;for(var s in n)n.hasOwnProperty(s)&&(r=n[s],s=="title"?this.$title.text=r:(i=this.$document.createElement("meta"),i.setAttribute("name",s),i.setAttribute("content",r),this.$head.appendChild(i),this.$metaTags.push(i)))}})}),define("js/core/Injection",["js/core/Component","underscore"],function(e,t){function n(e,t){return e==t||e.prototype instanceof t}return e.inherit("js.core.Injection",{ctor:function(e,t,n,r,i){n.$injection?(this.$singletonInstanceCache=n.$injection.$singletonInstanceCache,this.$factories=n.$injection.$factories,this.callBase()):(this.$singletonInstanceCache=[],this.$factories=[])},_childrenInitialized:function(){this.callBase();for(var e=0;e<this.$configurations.length;e++){var t=this.$configurations[e];this.addFactory(t.$)}},getInstance:function(e){var r;if(t.isString(e)){if(this.$singletonInstanceCache.hasOwnProperty(e))return this.$singletonInstanceCache[e]}else{for(var i=0;i<this.$singletonInstanceCache.length;i++){r=this.$singletonInstanceCache[i];if(r instanceof e)return r}for(var s=0;s<this.$factories.length;s++){var o=this.$factories[s];if(n(o.factory,e)){r=new o.factory;if(r instanceof e)return o.singleton&&this.addInstance(r),r}}}throw"requested injection type not found"},addChild:function(e){this.callBase(e),this.addInstance(e)},addFactory:function(e){e instanceof Function&&(e={factory:e}),t.defaults(e,{type:null,factory:null,singleton:!1});if(!e.factory){var n=this.$stage.$requirejsContext((e.type||"").replace(/\./g,"/"));if(!n)throw"factory for type '"+e.type+"' not found";e.factory=n}this.$factories.push(e)},addInstance:function(e,t){arguments.length==1&&(t=e,e=null),e?this.$singletonInstanceCache[e]=t:this.$singletonInstanceCache.push(t)}})}),define("js/core/History",["js/core/Bindable","flow"],function(e,t){var n=/^#?!?\/?/,r,i=function(){},s=e.inherit("js.core.History",{ctor:function(){this.callBase(),this.$routers=[],this.$processUrl=!0,this.$history=[],this.$.useState===null&&this.set("useState",this.runsInBrowser()&&"onpopstate"in window)},defaults:{interval:50,useState:!1,baseUrl:"/"},fragment:function(){return this.$fragment}.on("change:fragment"),_getFragment:function(){var e;return this.runsInBrowser()?this.$.useState?e=(window.history.state||{}).fragment||"":e=decodeURI(window.location.hash):e=this.$history[this.$history.length-1]||"",e.replace(n,"")},start:function(e,t){var n=this,r;this.$checkUrlFn=function(){n.checkUrl.apply(n,arguments)},this.runsInBrowser()?this.$.useState?(r=window.location.pathname,r=r.replace(new RegExp("^"+(this.$.baseUrl||"")),""),window.addEventListener?window.addEventListener("popstate",this.$checkUrlFn,!1):window.attachEvent("onpopstate",this.$checkUrlFn)):"onhashchange"in window?window.addEventListener?window.addEventListener("hashchange",this.$checkUrlFn,!1):window.attachEvent("onhashchange",this.$checkUrlFn):this.$checkUrlInterval=setInterval(this.$checkUrlFn,this.$.interval):this.$history.push(t||""),r=r||this._getFragment(),this.navigate(r,!1,!0,!0,e),this.$processUrl=!0},back:function(){window.history.back()},stop:function(){typeof window!="undefined"&&(this.$.useState?window.removeEventListener?window.removeEventListener("popstate",this.$checkUrlFn,!1):window.detachEvent("onpopstate",this.$checkUrlFn):"onhashchange"in window?window.removeEventListener?window.removeEventListener("hashchange",this.$checkUrlFn,!1):window.detachEvent("onhashchange",this.$checkUrlFn):clearInterval(this.$checkUrlInterval))},addRouter:function(e){this.$routers.push(e)},checkUrl:function(){if(this.$processUrl){var e=this._getFragment();if(e==this.$fragment)return!1;this.navigate(e,!this.$.useState,!0,!0,i)}this.$processUrl=!0},triggerRoute:function(e,n){var r=[];for(var i=0;i<this.$routers.length;i++)r=r.concat(this.$routers[i].generateRoutingStack(e));r.length===0?(this.log("no route for '"+e+"' found."),n&&n()):t().seqEach(r,function(e,t){e(t)}).exec(n)},navigate:function(e,t,n,i,o){var u=this;!o&&t instanceof Function&&(o=t,t=null),!o&&n instanceof Function&&(o=n,n=null),!o&&i instanceof Function&&(o=i,i=null);if(t==r||t===null)t=!0;if(n==r||n===null)n=!0;var a={fragment:e,createHistoryEntry:t,triggerRoute:n},f=this._getFragment()!==e;if(!f&&!i){o&&o();return}this.trigger(s.EVENTS.NAVIGATION_START,a),this.$processUrl=f,t?(this.runsInBrowser()?this.$.useState?(console.log("Pushing "+e+" to history"),window.history.pushState({fragment:"/"+e},null,this.$.baseUrl+e)):window.location.hash="/"+encodeURI(e):this.checkUrl(null),this.$history.push(e)):(this.runsInBrowser()&&(this.$.useState?(console.log("Replacing "+e+" to history"),window.history.replaceState({fragment:"/"+e},null,this.$.baseUrl+e)):window.location.replace("#/"+e)),this.$history[this.$history.length-1]=e),this.$processUrl=!0,this.$fragment!==e&&(this.$fragment=e,this.trigger("change:fragment",this.$fragment)),n?this.triggerRoute(e,function(){u.trigger(s.EVENTS.NAVIGATION_COMPLETE,a),o&&o.apply(u,arguments)}):this.trigger(s.EVENTS.NAVIGATION_COMPLETE,a)}});return s.EVENTS={NAVIGATION_START:"navigationStart",NAVIGATION_COMPLETE:"navigationComplete"},s}),define("xaml",[],function(){function u(e){return/\S/.test(e)}function a(e,t,n,r,i){n=n||{},i=i||{},r=r||[],e=n[e]||e,e||console.warn("It seems that you forgot to add a namespace. Try using xmlns='http://www.w3.org/1999/xhtml' in your xaml"),e=e.replace(/\./g,"/");var s=[e,t].join("/");for(var o=0;o<i.length;o++){var u=i[o];if(u.$from&&u.$to&&u.$from.test(s)){s=s.replace(u.$from,u.$to);break}}return r.indexOf(s)!==-1&&(s="xaml!"+s),s.replace(/\./g,"/")}function f(e){var t=e.textContent||e.text||e.data;if(!t){t="";for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(r.nodeType==1||r.nodeType==4)t+=this._getTextContentFromDescriptor(r)}}return t}function l(e,t,n,r,i,u){function c(e){var h=o(e),p=a(e.namespaceURI,h,t,n,r);if(p=="js/core/Imports")for(var d=0;d<e.childNodes.length;d++){var v=e.childNodes[d];if(v.nodeType==3){var m,g=f(v);while((m=s.exec(g+" "))!=null){var y=m[0].replace(/\./g,"/");y!=="undefined"&&(l.indexOf(y)==-1&&l.push(y),i&&i.push(y))}}}l.indexOf(p)==-1&&p!==u&&l.push(p);for(var b=0;b<e.childNodes.length;b++){var w=e.childNodes[b];w.nodeType==1&&c(w)}}var l=[];return e&&c(e),l}function c(e,t,n,r){var i=[];for(var s=0;s<e.childNodes.length;s++){var u=e.childNodes[s];u.nodeType==1&&"js/core/Script"==a(u.namespaceURI,o(u),t,n,r)&&i.push(u)}return i}function h(e){var t={};if(e)for(var n=0;n<e.length;n++){var r=e[n];for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}var e,t,n=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=function(e,t){throw new Error("Environment unsupported.")},i={},s=/((?:xaml!)?[a-z]+(\.[a-z]+[a-z0-9]*)*)/mgi;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1});var o=function(e){if(e.localName)return e.localName;var t=e.tagName.split(":");return t[t.length-1]};return typeof window!="undefined"&&window.navigator&&window.document||typeof importScripts!="undefined"?(t=function(){var e,t,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(t=0;t<3;t++){r=n[t];try{e=new ActiveXObject(r)}catch(i){}if(e){n=[r];break}}if(!e)throw new Error("getXhr(): XMLHttpRequest not available");return e},r=function(e,n){var r=/^data:/;if(r.test(e))try{var i=e.replace(r,"").replace(/\.xml$/,"");n(null,(new DOMParser).parseFromString(i,"application/xml"))}catch(s){n(s)}else{var o;try{o=t(),o.open("GET",e,!0),o.onreadystatechange=function(){o.readyState===4&&(o.status===200||o.status===304?o.responseXML?n(null,o.responseXML):n("no responseXML found"):n("got status "+o.status+" for "+e))},o.send(null)}catch(s){n(s)}}}):typeof process!="undefined"&&process.versions&&!!process.versions.node&&(e=require.nodeRequire("fs"),r=function(t,n){try{var r=e.readFileSync(t,"utf8"),i=require.nodeRequire("xmldom").DOMParser;n(null,(new i).parseFromString(r))}catch(s){n(s)}}),{write:function(e,t,n){if(t in i){var r=i[t];n.asModule(e+"!"+t,r)}},version:"0.2.0",load:function(e,t,n,s){var o=t.toUrl(e+".xml");s.optimizedXAML&&s.optimizedXAML.indexOf(e)>-1?t([e],function(){t(["xaml!"+e],function(e){n(e)})}):r(o,function(r,a){if(!r&&a){var f=[],p=1,d=l(a.documentElement,s.namespaceMap,s.xamlClasses,s.rewriteMap,f,"xaml!"+e),v=c(a.documentElement,s.namespaceMap,s.xamlClasses,s.rewriteMap);if(v.length>1)throw"only one script block allowed in XAML";v.length>0&&(d.splice(1,0,"js/core/Script"),p++),f.length>0&&(d=d.slice(0,p).concat(f).concat(d.slice(p)));if(s.isBuild){d.splice(1,0,"js/core/Element"),p++;var m="define(%dependencies%, %function%)",g="function(baseClass, ELEMENT %parameter%){%GLOBALS% return baseClass.inherit({ %classDefinition% _$descriptor: ELEMENT.xmlStringToDom(%descriptor%)})}",y=[];for(var b=0;b<d.length;b++)y.push("'"+d[b]+"'");m=m.replace("%dependencies%","["+y.join(",")+"]");var w=a.documentElement.toString().replace(/\\/g,"\\\\").replace(/(\r\n|\n|\r)/gm,"\\n").replace(/'/g,"\\'").replace(/<js:Script[^>]*>[\s\S]*<\/js:Script[^>]*>/,"");s.removeSpaces===!0&&(w=w.replace(/\s+/g," ").replace(/\\[nr]/g,""));var E="",S="",x="";if(v.length>0){var T=v[0].toString(),N=/^[\s\S]*?function\s*\(([\s\S]*?)\)[\s\S]*?\{([\s\S]*?)return[\s\S]*?\{([\s\S]*)\}[\s\S]*?\}[\s\S]*?\)[^)]*$/,C=N.exec(T);if(!C)throw"Error parsing script block";u(C[1])&&(E=",SCRIPT,"+C[1]),u(C[2])&&(x=C[2]),u(C[3])&&(S=C[3]+",")}g=g.replace("%parameter%",E),g=g.replace("%classDefinition%",S),g=g.replace("%GLOBALS%",x),g=g.replace("%descriptor%","'"+w+"'"),m=m.replace("%function%",g),n.fromText(e,"(function () {"+m+"}).call(this);"),i[e]=m,t([e],function(e){t(d,function(){n(e)})})}else t(d,function(t){var r=arguments[0],i=arguments[1],s=Array.prototype.slice.call(arguments),o=[],u=s.slice(p);if(v.length>0)for(var f=0;f<v.length;f++)try{var l=new i(null,v[f]);o.push(l.evaluate(u))}catch(c){n.error(new Error(e+": Script cannot be loaded"+c))}var d=r.inherit(e.replace(/\//g,"."),h(o));d.prototype._$descriptor=a.documentElement,n(d)},function(e){n.error(e)})}else n.error(new Error("XML "+o+" not found."+r))})}}}),define("js/lib/extension",[],function(){var e=Math.round;return Math.round=function(t,n){if(n){var r=Math.pow(10,n);return e(t*r)/r}return e(t)},Date.now||(Date.now=function(){return+(new Date)}),typeof window!="undefined"&&!window.getComputedStyle&&(window.getComputedStyle=function(e){return this.el=e,this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;return t=="float"&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null},this}),!0}),define("js/core/Application",["js/core/Window","js/html/HtmlElement","js/lib/extension","underscore","require","flow","js/core/Bindable"],function(e,t,n,r,i,s,o){return e.inherit("js.core.Application",{$classAttributes:[/.+/],_inject:function(){},_initializeDescriptors:function(){this.callBase(),t.prototype._inject.call(this)},start:function(e,t){this.show(),this._startHistory(t,e.initialHash)},_getEnvironment:function(){return this.$stage.$environmentName},applicationDefaultNamespace:"app",supportEnvironments:!1,_startHistory:function(e,t){this.$stage.$history.start(e,t)},render:function(e){var t=this.callBase(e);return this.$stage.$bus.trigger("Application.Rendered"),t}},{setupEnvironment:function(e,t,n,o){var u,a;s().par(function(e){i(["json!"+n+"/env/default"],function(t){u=t,e()},function(t){e(t)})},function(e){t?i(["json!"+n+"/env/"+t],function(t){a=t,e()},function(t){e(t)}):e()}).exec(function(t){e.set(r.extend({},u,a)),o&&o(t)})}})}),define("app/IndexClass",["js/core/Application","js/core/History"],function(e,t){return e.inherit({inject:{history:t},initialize:function(){this.set("pages",[{label:"Home",link:"home"},{label:"Wiki",link:"wiki"},{label:"UI Components",link:"ui"},{label:"API",link:"api"},{label:"Try it",link:"http://try.rappidjs.com"},{label:"License",link:"license"},{label:"Disclaimer",link:"disclaimer"}])},isPageSelected:function(e){var t=this.get("history.fragment()");return t?t.indexOf(e.link)>-1:!1}.on(["history","change:fragment"]),start:function(e,t){this.callBase(e,t)},defaultRoute:function(e){e.navigate("home")}.async()})}),define("js/conf/Configuration",["js/core/Component"],function(e){return e.Configuration}),define("js/conf/RouteConfiguration",["js/conf/Configuration"],function(e){return e.inherit("js.conf.RouteConfiguration",{defaults:{name:null,route:null},events:["exec"]})}),define("js/core/Router",["js/core/Component","underscore","js/conf/RouteConfiguration"],function(e,t,n){return e.inherit("js.core.Router",{ctor:function(){this.$routes=[],this.callBase()},initialize:function(){this.callBase(),this.$.history?this.history=this.$.history:this.history=this.$stage.$history,this.history.addRouter(this)},_initializeChildren:function(e){this.callBase()},_childrenInitialized:function(){this.callBase();for(var e=0;e<this.$configurations.length;e++){var t=this.$configurations[e];t instanceof n&&this.addRoute(t.$)}},addRoute:function(){var e;arguments.length==2?e={route:arguments[0],fn:arguments[1]}:e=arguments[0],e.onexec&&(e.fn=this.$rootScope[e.onexec]),t.defaults(e,{name:null,route:null,fn:null}),e.route&&!(e.route instanceof RegExp)&&(e.route=new RegExp(e.route));if(!e.fn||!e.route)throw"fn and route required";this.$routes.push(e)},generateRoutingStack:function(e){function s(e,s){n.push(function(n){var o=s.shift(),u={callback:n,router:i,params:t.clone(s),fragment:o,route:e,end:function(){n.end()},navigate:function(e,r,s){t.isUndefined(r)&&(r=!1),i.navigate(e,r,s,n)}};s.unshift(u);if(e.fn._async)try{e.fn.apply(r,s)}catch(a){n(a)}else try{n(null,e.fn.apply(r,s))}catch(a){n(a)}})}var n=[],r=this.$rootScope,i=this;for(var o=0;o<this.$routes.length;o++){var u=this.$routes[o],a=u.route.exec(e);a&&s(u,a)}return n},executeRoute:function(e,n){var r=function(e,t){n&&n(e,t)};for(var i=0;i<this.$routes.length;i++){var s=this.$routes[i],o=s.route.exec(e);if(o){o.shift();var u={callback:r,router:this,params:t.clone(o),fragment:e,route:s};o.unshift(u);var a=this.$rootScope;if(s.fn._async)s.fn.apply(a,o);else try{r(null,s.fn.apply(a,o))}catch(f){r(f)}return!0}}return!1},navigate:function(e,t,n,r,i){return this.history.navigate(e,t,n,r,i)}})}),define("piwik/Tracker",["js/core/Component","js/core/Base","js/core/History","flow"],function(e,t,n,r){return e.inherit("piwik.Tracker",{defaults:{siteId:1,piwikUrl:null,baseUrl:null,enableLinkTracking:!0},initialize:function(){this.callBase(),this.$trackQueue=[],this.$tracker=null;var e=this.$stage.$history,r=this.$.piwikUrl;if(!e){this.log("History not found.",t.LOGLEVEL.ERROR);return}if(!r){this.log("PiwikUrl not defined",t.LOGLEVEL.WARN);return}/^.*\.php$/i.test(r)||(r=r.replace(/\/$/,"")+"/piwik.php");if(this.runsInBrowser()){e.bind(n.EVENTS.NAVIGATION_COMPLETE,function(e){e.$.triggerRoute&&e.$.createHistoryEntry&&(this.track(e.$.fragment),this._checkLinkTracking())},this);var i=this;require(["Piwik"],function(e){if(e&&e.getAsyncTracker){var t=e.getAsyncTracker();t&&(t.setSiteId(i.$.siteId),t.setTrackerUrl(r),i.$tracker=t,i.trackQueue(),i._checkLinkTracking())}})}},track:function(e){var t=this.$tracker;t?(t.setCustomUrl(e,this.$.baseUrl+"?fragment="+e),t.setDocumentTitle(e),t.trackPageView()):this.$trackQueue.push(e)},trackQueue:function(){var e=this;r().seqEach(this.$trackQueue,function(t,n){setTimeout(function(){e.track(t),n()},500)}).exec()},_checkLinkTracking:function(){this.$tracker&&this.$.enableLinkTracking&&this.$tracker.enableLinkTracking()},applicationRendered:function(){this._checkLinkTracking()}.bus("Application.Rendered")})}),define("js/html/A",["js/html/HtmlElement"],function(e){var t=/^(([^:]+:\/\/)|(javascript:)|(\/\/))/i,n=/^#?\/?/,r=/^#?(.*)$/;return e.inherit("js.html.A",{defaults:{tagName:"a",target:null,href:null},_initializationComplete:function(){this.callBase();var e=this.$stage.$history;e.$.useState&&this.bind("on:click",function(t){if(t.isDefaultPrevented)return;t.preventDefault(),e.navigate(this.plainHref())},this)},plainHref:function(){var e=this.$.href||"";return e.replace(n,"")},_renderHref:function(e){e=e||"javascript:void(0);";if(this.$.target!=="external"&&!t.test(e)&&this.$.target!=="_blank"){var n=this.plainHref();e="#/"+n,this.runsInBrowser()?this.$stage.$history.$.useState&&(e=n):e=e.replace(r,"#!$1")}this.$el.setAttribute("href",e)},_renderTarget:function(e){e&&e!=="external"&&this.$el.setAttribute("target",e)}})}),define("js/core/List",["js/core/EventDispatcher","js/core/Bindable","underscore"],function(e,t,n){var r=t.inherit("js.core.List",{ctor:function(e,t){function r(){n.length=n.size()}t=t||{},this.$items=[],this.$itemEventMap={},this.callBase(t),e&&this.add(e);var n=this;this.bind("add",r),this.bind("remove",r),this.bind("reset",r),this.length=this.size()},isEmpty:function(){return this.$items.length===0}.on("*"),push:function(e){this.add(e)},pop:function(){return this.removeAt(this.$items.length-1)},shift:function(){return this.removeAt(0,{})},unshift:function(e){this.add(e,{index:0})},add:function(e,r){r=r||{},n.defaults(r,{silent:!1,index:this.$items.length});var i=r.index;n.isArray(e)||(e=[e]);var s,o;for(var u=0;u<e.length;u++)s=e[u],s instanceof t&&(s.bind("change",this._onItemChange,this),s.bind("*",this._onItemEvent,this)),o=i+u,n.isUndefined(this.$items[o])||o>=this.$items.length?this.$items[o]=s:this.$items.splice(o,0,s),r.silent!==!0&&this.trigger("add",{item:s,index:o})},_onItemChange:function(e,t){this.trigger("change",{item:t,index:this.indexOf(t),changedAttributes:e.$})},_onItemEvent:function(e,t){this.$itemEventMap[e.type]&&this.trigger("item:"+e.type,{item:t,index:this.indexOf(t),itemEvent:e})},remove:function(e,t){var r=[];n.isArray(e)||(e=[e]);var i;for(var s=0;s<e.length;s++)i=this.removeAt(this.indexOf(e[s]),t),i&&r.push(i);return r},indexOf:function(e){return this.$items.indexOf(e)},removeAt:function(e,n){n=n||{};if(e>-1&&e<this.$items.length){var r=this.$items.splice(e,1),i=r[0];return n.silent!==!0&&this.trigger("remove",{item:i,index:e}),i instanceof t&&(i.unbind("*",this._onItemEvent,this),i.unbind("change",this._onItemChange,this)),r[0]}return null},reset:function(t,n){t=t||[];var r=this;this.each(function(t){t instanceof e&&(t.unbind("*",r._onItemEvent,r),t.unbind("change",r._onItemChange,r))}),this.$items=t||[],this.each(function(t){t instanceof e&&(t.bind("*",r._onItemEvent,r),t.bind("change",r._onItemChange,r))}),n=n||{},n.silent||this.trigger("reset",{items:t})},clear:function(e){this.reset([],e)},size:function(){return this.$items.length}.on("*"),at:function(e){return e<this.$items.length&&e>=0?this.$items[e]:null}.on("*"),each:function(e,t){t=t||this;if(t["break"])throw"each would overwrite break";if(t["return"])throw"each would overwrite return";var n=!1,r,i;t["break"]=function(){n=!0},t["return"]=function(e){n=!0,r=e};for(var s=0;s<this.$items.length;s++){try{e.call(t,this.$items[s],s,this.$items)}catch(o){i=o,n=!0}if(n)break}t["break"]=undefined,t["return"]=undefined;if(i)throw i;return r},includes:function(e){var t=this.each(function(t){t===e&&this["return"](!0)});return t?t:!1}.on("*"),clone:function(){var e=this._cloneAttribute(this.$),t=this._cloneAttribute(this.$items),n=new this.factory(t,e);return n._$source=this,n},sync:function(){if(this._$source){var e,n=[];for(var r=0;r<this.$items.length;r++)e=this.$items[r],e instanceof t&&e.sync()&&(e=e._$source),n.push(e);this._$source.reset(n)}return this.callBase()},_innerDestroy:function(){this.$itemEventMap={},this.callBase()},bind:function(e,t,n){var r=e.indexOf("item:");if(r===0){var i=e.substr("item:".length);this.$itemEventMap[i]=this.$itemEventMap[i]||[],this.$itemEventMap[i].push({eventType:e,callback:t,scope:n})}this.callBase()},unbind:function(e,t,n){var r=e.indexOf("item:");if(r===0){var i=e.substr("item:".length),s=this.$itemEventMap[i]||[],o;for(var u=s.length-1;u>-1;u--)o=s[u],o.callback===t&&o.scope===n&&s.splice(r,1)}this.callBase()},toArray:function(e){var t=[];return e=e||function(e,t){return e},this.each(function(n,r){t.push(e(n,r))}),t},sort:function(e){return e instanceof Function&&this.trigger("sort",{items:this.$items.sort(e),sortFnc:e}),this},isDeepEqual:function(e){if(e.size()!==this.size())return!1;var r=!0,i,s;for(var o=0;o<this.$items.length;o++){i=this.$items[o],s=e.at(o);if(i instanceof t&&s instanceof t){if(!i.isDeepEqual(s))return!1}else{if(i instanceof t||s instanceof t)return!1;r=n.isEqual(i,s)}}return r}});return r}),define("js/core/Repeat",["js/core/Component","js/core/Bindable","js/core/List"],function(e,t,n){return e.inherit("js.core.Repeat",{defaults:{items:null,itemKey:"item",indexKey:"index",keyPath:null},events:["on:itemsRendered"],$defaultTemplateName:"item",ctor:function(){this.$renderedItems=[],this.$renderedItemsMap={},this.callBase(),this.bind("items","sort",this._onSort,this),this.bind("items","reset",this._onReset,this),this.bind("items","add",this._onItemAdd,this),this.bind("items","remove",this._onItemRemove,this)},_commitChangedAttributes:function(e){this.callBase(e),e.items&&this._innerRenderItems(this._getItemsArray(e.items))},_getItemsArray:function(e){return e?e instanceof n?e.$items:_.isArray(e)?e:[]:[]},_onSort:function(e){var t,n;for(var r=0;r<e.$.items.length;r++)t=e.$.items[r],n=this.getComponentForItem(t),this.$parent.removeChild(n),this._innerAddChild(n)},_onReset:function(e){this._innerRenderItems(e.$.items)},_onItemAdd:function(e){this._innerRenderItem(e.$.item,e.$.index)},_onItemRemove:function(e){this._removeRenderedItem(e.$.item)},_innerRenderItems:function(e){var t,n;if(this.$renderedItems)for(n=this.$renderedItems.length-1;n>=0;n--)t=this.$renderedItems[n],this.$parent.removeChild(t.component),t.component.destroy();if(this.$renderedItemsMap){var r;for(var i in this.$renderedItemsMap)if(this.$renderedItemsMap.hasOwnProperty(i)){r=this.$renderedItemsMap[i];for(n=r.length-1;n>=0;n--)t=r[n],this.$parent.removeChild(t.component),t.component.destroy()}}this.$renderedItems=[],this.$renderedItemsMap={},this.$indexOffset=0;if(e)for(var s=0;s<e.length;s++)this._innerRenderItem(e[s],s);this.trigger("on:itemsRendered",{},this)},_createComponentForItem:function(t,n){var r={};r[this._getItemKey()]=t,r[this._getIndexKey()]=n;var i=this.createComponent(e,r);i.$parentScope=this.$templates.item,i.$rootScope=this.$templates.item.$rootScope,i._initialize();var s=this.$templates.item.createComponents(r,i)[0];return s.$classAttributes&&s.$classAttributes.push(this.$.itemKey,this.$.indexKey),s},_cacheComponentForItem:function(e,t){var n=this._getKeyForItem(e),r={item:e,component:t};return n?this.$renderedItemsMap[n]?this.$renderedItemsMap[n].push(r):this.$renderedItemsMap[n]=[r]:this.$renderedItems.push(r),t},_getKeyForItem:function(e){return e instanceof t?this.$.keyPath?e.get(this.$.keyPath):e.$cid:this.$.keyPath&&e instanceof Object?this.get(e,this.$.keyPath):_.isString(e)||_.isNumber(e)?e:null},_innerRenderItem:function(e,t){var n=this._createComponentForItem(e,t);this._cacheComponentForItem(e,n),this._innerAddChild(n,t)},_innerAddChild:function(e,t){var n=this._calculateIndexOffsetForChild(e);this.$parent.addChild(e,{childIndex:t+n})},_calculateIndexOffsetForChild:function(e){var t=0,n;for(var r=0;r<this.$parent.$children.length;r++){n=this.$parent.$children[r];if(n===this)return++t;t++}return t},_getItemKey:function(){return this.$.itemKey},_getIndexKey:function(){return this.$.indexKey},_removeRenderedItem:function(e){var t,n=this._getKeyForItem(e),r,i=this.$renderedItems;n&&(i=this.$renderedItemsMap[n]);for(var s=0;s<i.length;s++){t=i[s];if(t.item===e){this.$parent.removeChild(t.component),i.splice(s,1),t.component.destroy();return}}},getComponentForItem:function(e){var t=this._getKeyForItem(e),n=this.$renderedItems;t&&(n=this.$renderedItemsMap[t]);if(n){var r;for(var i=0;i<n.length;i++){r=n[i];if(r.item===e)return r.component}}return null}})}),define("js/ui/ItemsView",["js/ui/View","js/core/Repeat"],function(e,t){return e.inherit("js.ui.ItemsView",{defaults:{items:null,itemKey:"item",indexKey:"index"},$defaultTemplateName:"item",createChildren:function(){var e=this.callBase()||[],n=this.createComponent(t,{items:"{items}",itemKey:this.$.itemKey,indexKey:this.$.indexKey},null);return this.$repeat=n,n.$defaultTemplateName=null,n.bind("on:itemsRendered",this._onItemsRendered,this),e.push(n),e},addChild:function(e){e instanceof t&&e.addChild(this.$templates.item),this.callBase()},_onItemsRendered:function(){},_getItemKey:function(){return this.$repeat._getItemKey()},_getItemsArray:function(){return this.$repeat._getItemsArray.apply(this.$repeat,arguments)},getComponentForItem:function(){return this.$repeat.getComponentForItem.apply(this.$repeat,arguments)}})}),define("js/core/Template",["js/core/Component"],function(e){return e.Template}),define("js/ui/ContentPlaceHolder",["js/ui/View"],function(e){return e.inherit({defaults:{name:null},_renderContent:function(e){this._clearRenderedChildren(),this.$children=[],e&&(this.$children=e.getChildren(),this._renderChildren(this.$children))}})}),define("js/core/Head",["js/core/Component"],function(e){return e.inherit("js.core.Head",{ctor:function(){this.callBase(),this.$headManager=this.$stage.$headManager,this.bind("change",this.render,this)},defaults:{title:null,head:null,author:null},render:function(){this.$headManager.set(this.$)}})}),define("js/core/Module",["js/html/HtmlElement","js/core/Router","js/core/Head"],function(e,t,n){return e.inherit("js.core.Module",{ctor:function(){this.callBase(),this.$routers=[]},start:function(e,t){this.$head&&this.$head.render(),e&&e()},_unload:function(e){e&&e()},render:function(e){},addChild:function(e){this.callBase(),e instanceof t&&this.$routers.push(e),e instanceof n&&(this.$head=e)}})}),define("js/conf/ModuleConfiguration",["js/conf/Configuration"],function(e){return e.inherit("js.conf.ModuleConfiguration",{defaults:{route:null,name:null,moduleClass:null,attributes:null}})}),define("js/core/ModuleLoader",["require","js/html/HtmlElement","js/ui/ContentPlaceHolder","js/core/Module","underscore","js/conf/ModuleConfiguration","flow"],function(e,t,n,r,i,s,o){var u=t.inherit("js.core.ModuleLoader",{$classAttributes:["router","currentModuleName","state"],defaults:{currentModuleName:null,$currentModule:null,tagName:"div",componentClass:"module-loader",state:null,router:null},ctor:function(e){this.callBase(),this.$modules={},this.$moduleCache={}},_initializationComplete:function(){this.callBase();for(var e=0;e<this.$configurations.length;e++){var t=this.$configurations[e];t instanceof s&&this.addModule(t.$)}},addModule:function(e){i.defaults(e,{name:null,moduleClass:null,route:null,attributes:null});if(!e.name)throw"module cannot be added: module name is required";if(!e.moduleClass)throw"no moduleClass defined for module";if(this.$modules.hasOwnProperty(e.name))throw"module with name '"+e.name+"' already registered";this.$modules[e.name]=e;if(e.route){if(!this.$.router)throw"defining modules with routes requires a router instance to be set";var t=this;this.$.router.addRoute({name:e.name,route:e.route,fn:function(n){t.loadModule(e,n.callback,n)}.async()})}},_startModule:function(e,t,n,r,i){var s=this;o().seq(function(e){var t=s.$.$currentModule;t?t._unload(e):e()}).seq(function(e){t.start(function(n){if(n||i)e(n);else if(r){var s=[];for(var u=0;u<t.$routers.length;u++)s=s.concat(t.$routers[u].generateRoutingStack(r.fragment));o().seqEach(s,function(e,t){e(t)}).exec(e)}else e()},r)}).seq(function(){s._clearContentPlaceHolders(),s.set("currentModuleName",e);var n=s.getContentPlaceHolders();for(var r=0;r<n.length;r++){var i=n[r];i.set("content",t.findContent(i.$.name))}}).exec(function(e){s.set({state:e?"error":null,$currentModule:t}),n&&n(e,t)})},loadModule:function(t,n,i){var s=this;n=n||function(){},t.hasOwnProperty("name")||(t=this.$modules[t]),t||n("module not found"),t.name===this.$.currentModuleName?n&&n():o().seq(function(){s.set("currentModuleName",null),s.set("state","unloading loading")}).seq(function(n){s.set("state","loading"),s._clearContentPlaceHolders(),s.$lastModuleName=s.$.currentModuleName,s.$moduleCache.hasOwnProperty(t.name)?s._startModule(t.name,s.$moduleCache[t.name],n,i,!0):e([s.$stage.$applicationContext.getFqClassName(t.moduleClass)],function(e){var o=new e(t.attributes,!1,s.$stage,null,null);o instanceof r?(typeof CollectGarbage=="function"&&CollectGarbage(),o._initialize("auto"),s.$moduleCache[t.name]=o,s._startModule(t.name,o,n,i,!1)):n(new Error("Module '"+t.moduleClass+"' isn't an instance of js.core.Module"))},function(e){n(e)})}).exec(function(e){e&&(s.set("state","error"),s.log(e,"warn")),n(e)})},isModuleActive:function(e){return this.$.currentModuleName==e}.onChange("currentModuleName"),_clearContentPlaceHolders:function(){var e=this.getContentPlaceHolders();for(var t=0;t<e.length;t++){var n=e[t];n.set("content",null)}},moduleNames:function(){var e=[],t;for(var n=0;n<this.$configurations.length;n++)t=this.$configurations[n],t instanceof s&&e.push(t.$.name);return e},_renderState:function(e,t){t&&this.removeClass(t),e&&this.addClass(e)}});return u.findContentPlaceHolders=function(e){var t=[];for(var r=0;r<e.$children.length;r++){var i=e.$children[r];i instanceof n?t.push(i):t.concat(u.findContentPlaceHolders(i))}return t},u}),define("xaml!app/Index",["app/IndexClass","js/core/Element","js/core/Router","js/conf/RouteConfiguration","piwik/Tracker","js/html/HtmlElement","js/html/A","js/ui/ItemsView","js/core/Template","js/core/ModuleLoader","js/conf/ModuleConfiguration","js/ui/ContentPlaceHolder"],function(e,t){return e.inherit({_$descriptor:t.xmlStringToDom('<app:IndexClass xmlns="http://www.w3.org/1999/xhtml" xmlns:js="js.core" xmlns:ui="js.ui" xmlns:app="app" xmlns:conf="js.conf" xmlns:piwik="piwik">\n\n    <js:Router cid="router">\n        <conf:RouteConfiguration route="^$" onexec="defaultRoute"/>\n    </js:Router>\n\n    <piwik:Tracker piwikUrl="http://piwik.rappidjs.com" baseUrl="http://www.rappidjs.com"/>\n\n    <header id="header" class="navbar navbar-fixed-top">\n        <div class="navbar-inner">\n            <div class="container">\n                <a class="brand" href="#">\n                    &lt;rAppid:js />\n                </a>\n                <nav>\n                    <ui:ItemsView items="{pages}" tagName="ul" class="nav">\n                        <js:Template name="item">\n                            <li selected="{isPageSelected(item)}">\n                                <a href="${item.link}">${item.label}</a>\n                            </li>\n                        </js:Template>\n                    </ui:ItemsView>\n                </nav>\n            </div>\n        </div>\n    </header>\n\n    <js:ModuleLoader router="{router}" cid="moduleLoader">\n\n        <conf:ModuleConfiguration name="home" moduleClass="app.module.Home" route="^home.*$"/>\n        <conf:ModuleConfiguration name="wiki" moduleClass="app.module.Wiki" route="^wiki.*$"/>\n        <conf:ModuleConfiguration name="ui" moduleClass="app.module.Ui" route="^ui.*$"/>\n        <conf:ModuleConfiguration name="documentation" moduleClass="app.module.Documentation" route="^api.*$"/>\n        <conf:ModuleConfiguration name="license" moduleClass="app.module.License" route="^license$"/>\n        <conf:ModuleConfiguration name="disclaimer" moduleClass="app.module.Disclaimer" route="^disclaimer$"/>\n\n        <div id="container" class="container">\n            <ui:ContentPlaceHolder name="main"/>\n        </div>\n\n    </js:ModuleLoader>\n\n    <footer class="footer">\n        <div class="container">\n            <div class="row">\n                <div class="span4">\n                    <h3>idea &amp; development</h3>\n                    <p>\n                        <a href="http://tonyfindeisen.de">Tony Findeisen</a> and <a href="https://github.com/krebbl">Marcus Krejpowicz</a>.\n                        <br/>\n                        Licensed under the <a href="/license">MIT License</a>.\n                    </p>\n                </div>\n                <div class="span4">\n                    <h3>thanks</h3>\n                    <p>\n                        Developed with the use of <a href="http://requirejs.org/" target="_blank">requirejs</a>,\n                        <a href="https://github.com/it-ony/flow.js">flow.js</a>,\n                        <a href="http://underscorejs.org/" target="_blank">underscore.js</a>,\n                        <a href="https://github.com/it-ony/inherit.js" target="blank">inherit.js</a> and <a href="http://search.npmjs.org/#/ejs" target="blank">ejs</a>.\n                        Tested with <a href="http://visionmedia.github.com/mocha/" target="blank">mocha</a> and <a href="http://chaijs.com/" target="blank">chai</a>. Distributed with <a href="http://npmjs.org/" target="blank">npm</a> and <a href="http://nodejs.org" target="blank">node</a>.\n                    </p>\n                </div>\n                <div class="span4">\n                    <h3>Imprint</h3>\n                    <p>\n                        <img src="img/imprint.png"/>\n                        <a href="/disclaimer">Disclaimer</a>.\n                    </p>\n                </div>\n\n            </div>\n        </div>\n\n    </footer>\n\n</app:IndexClass>')})}),define("app/Index",function(){});