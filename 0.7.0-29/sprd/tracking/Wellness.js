define(["js/core/Component","underscore","flow","js/lib/extension"],function(e,t,n,r){var i;return e.inherit("sprd.tracking.Omniture",{defaults:{enabled:!0,debug:!1,context:"shop",contextId:null,application:null,version:null,locale:null,host:null,platform:"EU",basePath:"/sprd-frontend/wellness/track"},ctor:function(){this.$trackQueue=[],this.$trackedEvents=[];var e=this,t=0,n;this.$tracker={track:function(r,s){var o=[e.$.basePath,(e.$.platform||"EU").toLowerCase(),e.$.context==="shop"?e.$.contextId:-1,e.$.application,e.$.version||-1,r];n&&!s.hasOwnProperty("callback")&&(s.callback=n);for(var u in s)s.hasOwnProperty(u)&&(s[u]===null||s[u]===i)&&(s[u]="");s.locale=s.locale||e.$.locale||"",s.localTime=s.localTime||Date.now().toString(),o=o.join("/")+"?"+rAppid.createQueryString(s),e.$.host&&(o="//www"+ ++t%10+"."+e.$.host+o);var a=document.getElementsByTagName("head")[0],f=document.createElement("script");f.type="text/javascript",f.src=o,f.async=!0,a&&a.appendChild(f)}},this.callBase(),this.runsInBrowser()&&(n="wellnessTracking"+this.$cid,window[n]=window[n]||function(){})},_queueOrExecute:function(e){if(!this.runsInBrowser()||!this.$.enabled)return;if(this.$tracker)try{e.apply(this.$tracker)}catch(t){this.log(t,"error")}else this.$trackQueue.push(e)},_trackQueue:function(){var e=this;n().seqEach(this.$trackQueue,function(t){t.apply(e.$pageTracker)}).exec(function(){e.$trackQueue=[]})},_debug:function(e){this.$.debug&&this.log(e)},track:function(e,n){n=n||{};var r=[e],i,s=t.keys(n);for(var o=0;o<s.length;o++){var u=s[o];u!=="callback"&&r.push(u,n[u])}i=r.join("_");if(i){if(t.indexOf(this.$trackedEvents,i)!==-1)return;this.$trackedEvents.push(i)}var a=t.clone(n);this._queueOrExecute(function(){if(typeof qaContext!="undefined"&&qaContext.getTrackings())try{qaContext.getTrackings().push({service:"wellness",type:"track",action:e,data:a})}catch(t){}this.track(e,a)});if(this.$.debug){var f=e+"-> ";for(var l in a)a.hasOwnProperty(l)&&l!=="callback"&&(f+=l+": "+a[l]+", ");this._debug(f)}}})});